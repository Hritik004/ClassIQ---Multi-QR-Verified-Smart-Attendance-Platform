


<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>QR Scanner</title>-->
<!--  <script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.3.8/html5-qrcode.min.js"></script>-->
<!--  <style>-->
<!--    * {-->
<!--      margin: 0;-->
<!--      padding: 0;-->
<!--      box-sizing: border-box;-->
<!--    }-->

<!--    body {-->
<!--      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;-->
<!--      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);-->
<!--      min-height: 100vh;-->
<!--      padding: 20px;-->
<!--      color: #333;-->
<!--    }-->

<!--    .container {-->
<!--      max-width: 400px;-->
<!--      margin: 0 auto;-->
<!--      background: rgba(255, 255, 255, 0.95);-->
<!--      border-radius: 20px;-->
<!--      padding: 25px;-->
<!--      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);-->
<!--      backdrop-filter: blur(10px);-->
<!--    }-->

<!--    h1 {-->
<!--      text-align: center;-->
<!--      color: #4a5568;-->
<!--      margin-bottom: 25px;-->
<!--      font-size: 28px;-->
<!--      font-weight: 700;-->
<!--    }-->

<!--    .scanner-container {-->
<!--      background: #f7fafc;-->
<!--      border-radius: 15px;-->
<!--      padding: 20px;-->
<!--      margin-bottom: 20px;-->
<!--      border: 2px dashed #e2e8f0;-->
<!--      transition: all 0.3s ease;-->
<!--    }-->

<!--    .scanner-container.active {-->
<!--      border-color: #48bb78;-->
<!--      box-shadow: 0 0 20px rgba(72, 187, 120, 0.2);-->
<!--    }-->

<!--    #reader {-->
<!--      width: 100% !important;-->
<!--      max-width: 300px;-->
<!--      margin: 0 auto;-->
<!--      border-radius: 10px;-->
<!--      overflow: hidden;-->
<!--    }-->

<!--    .progress-container {-->
<!--      background: #edf2f7;-->
<!--      border-radius: 10px;-->
<!--      padding: 15px;-->
<!--      margin-bottom: 15px;-->
<!--      text-align: center;-->
<!--    }-->

<!--    .progress-bar {-->
<!--      background: #e2e8f0;-->
<!--      height: 8px;-->
<!--      border-radius: 4px;-->
<!--      overflow: hidden;-->
<!--      margin: 10px 0;-->
<!--    }-->

<!--    .progress-fill {-->
<!--      background: linear-gradient(90deg, #48bb78, #38a169);-->
<!--      height: 100%;-->
<!--      transition: width 0.3s ease;-->
<!--      border-radius: 4px;-->
<!--    }-->

<!--    .qr-counter {-->
<!--      font-size: 18px;-->
<!--      font-weight: 600;-->
<!--      color: #4a5568;-->
<!--      margin-bottom: 5px;-->
<!--    }-->

<!--    .qr-dots {-->
<!--      display: flex;-->
<!--      justify-content: center;-->
<!--      gap: 10px;-->
<!--      margin-top: 15px;-->
<!--    }-->

<!--    .qr-dot {-->
<!--      width: 12px;-->
<!--      height: 12px;-->
<!--      border-radius: 50%;-->
<!--      background: #e2e8f0;-->
<!--      transition: all 0.3s ease;-->
<!--    }-->

<!--    .qr-dot.scanned {-->
<!--      background: #48bb78;-->
<!--      transform: scale(1.2);-->
<!--      box-shadow: 0 0 10px rgba(72, 187, 120, 0.5);-->
<!--    }-->

<!--    .status-message {-->
<!--      text-align: center;-->
<!--      padding: 15px;-->
<!--      border-radius: 10px;-->
<!--      margin-top: 15px;-->
<!--      font-weight: 500;-->
<!--    }-->

<!--    .status-scanning {-->
<!--      background: #e6fffa;-->
<!--      color: #38b2ac;-->
<!--      border: 1px solid #b2f5ea;-->
<!--    }-->

<!--    .status-complete {-->
<!--      background: #f0fff4;-->
<!--      color: #38a169;-->
<!--      border: 1px solid #9ae6b4;-->
<!--    }-->

<!--    .status-badge {-->
<!--      display: inline-block;-->
<!--      padding: 8px 16px;-->
<!--      border-radius: 20px;-->
<!--      font-size: 14px;-->
<!--      font-weight: 600;-->
<!--    }-->

<!--    .status-success {-->
<!--      background: #48bb78;-->
<!--      color: white;-->
<!--    }-->

<!--    .scanner-instructions {-->
<!--      text-align: center;-->
<!--      color: #718096;-->
<!--      font-size: 14px;-->
<!--      margin-bottom: 15px;-->
<!--      line-height: 1.5;-->
<!--    }-->

<!--    .scanned-codes {-->
<!--      margin-top: 15px;-->
<!--      padding: 15px;-->
<!--      background: #f7fafc;-->
<!--      border-radius: 10px;-->
<!--      border: 1px solid #e2e8f0;-->
<!--    }-->

<!--    .scanned-codes h3 {-->
<!--      color: #4a5568;-->
<!--      margin-bottom: 10px;-->
<!--      font-size: 16px;-->
<!--    }-->

<!--    .code-item {-->
<!--      background: white;-->
<!--      padding: 8px 12px;-->
<!--      margin: 5px 0;-->
<!--      border-radius: 8px;-->
<!--      border: 1px solid #e2e8f0;-->
<!--      font-family: monospace;-->
<!--      font-size: 12px;-->
<!--      color: #4a5568;-->
<!--      word-break: break-all;-->
<!--    }-->

    /* Mobile optimizations */
<!--    @media (max-width: 480px) {-->
<!--      body {-->
<!--        padding: 10px;-->
<!--      }-->

<!--      .container {-->
<!--        padding: 20px;-->
<!--        border-radius: 15px;-->
<!--      }-->

<!--      h1 {-->
<!--        font-size: 24px;-->
<!--        margin-bottom: 20px;-->
<!--      }-->

<!--      #reader {-->
<!--        max-width: 100%;-->
<!--      }-->
<!--    }-->

    /* Hide QR scanner UI elements we don't need */
<!--    #reader__dashboard_section {-->
<!--      display: none !important;-->
<!--    }-->

<!--    #reader__header_message {-->
<!--      display: none !important;-->
<!--    }-->
<!--  </style>-->
<!--</head>-->
<!--<body>-->
<!--  <div class="container">-->
<!--    <h1>üîç QR Scanner</h1>-->

<!--    <div class="scanner-instructions">-->
<!--      Point your camera at QR codes to scan them. You need to scan 4 unique codes.-->
<!--    </div>-->

<!--    <div class="progress-container">-->
<!--      <div class="qr-counter">-->
<!--        <span id="scanned-count">0</span> / 4 QR Codes Scanned-->
<!--      </div>-->
<!--      <div class="progress-bar">-->
<!--        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>-->
<!--      </div>-->
<!--      <div class="qr-dots">-->
<!--        <div class="qr-dot" id="dot-1"></div>-->
<!--        <div class="qr-dot" id="dot-2"></div>-->
<!--        <div class="qr-dot" id="dot-3"></div>-->
<!--        <div class="qr-dot" id="dot-4"></div>-->
<!--      </div>-->
<!--    </div>-->

<!--    <div class="scanner-container" id="scanner-container">-->
<!--      <div id="reader"></div>-->
<!--    </div>-->

<!--    <div id="result">-->
<!--      <div class="status-message status-scanning">-->
<!--        üì± Scanner is ready. Start scanning QR codes!-->
<!--      </div>-->
<!--    </div>-->

<!--    <div id="scanned-codes-display" class="scanned-codes" style="display: none;">-->
<!--      <h3>Scanned Codes:</h3>-->
<!--      <div id="codes-list"></div>-->
<!--    </div>-->
<!--  </div>-->

<!--  <script>-->
    // Default course ID - in Flask template, replace this line with: const courseId = {{ course_id }};
<!--    const courseId = 1;-->
<!--    console.log('Course ID:', courseId);-->

<!--    let scannedQRCodes = [];-->
<!--    let html5QrcodeScanner;-->

<!--    function updateProgress() {-->
<!--      const count = scannedQRCodes.length;-->
<!--      const percentage = (count / 4) * 100;-->

<!--      document.getElementById('scanned-count').textContent = count;-->
<!--      document.getElementById('progress-fill').style.width = percentage + '%';-->

<!--      for (let i = 1; i <= 4; i++) {-->
<!--        const dot = document.getElementById(`dot-${i}`);-->
<!--        if (i <= count) {-->
<!--          dot.classList.add('scanned');-->
<!--        } else {-->
<!--          dot.classList.remove('scanned');-->
<!--        }-->
<!--      }-->

<!--      const scannerContainer = document.getElementById('scanner-container');-->
<!--      if (count > 0 && count < 4) {-->
<!--        scannerContainer.classList.add('active');-->
<!--      }-->

      // Show scanned codes
<!--      if (count > 0) {-->
<!--        const codesDisplay = document.getElementById('scanned-codes-display');-->
<!--        const codesList = document.getElementById('codes-list');-->
<!--        codesDisplay.style.display = 'block';-->

<!--        codesList.innerHTML = scannedQRCodes.map((code, index) =>-->
<!--          `<div class="code-item">${index + 1}. ${code}</div>`-->
<!--        ).join('');-->
<!--      }-->
<!--    }-->

<!--    function onScanSuccess(decodedText, decodedResult) {-->
<!--      console.log('QR Code detected:', decodedText);-->

<!--      if (!scannedQRCodes.includes(decodedText)) {-->
<!--        scannedQRCodes.push(decodedText);-->
<!--        updateProgress();-->

        // Show success message briefly
<!--        document.getElementById('result').innerHTML = `-->
<!--          <div class="status-message status-complete">-->
<!--            ‚úÖ QR Code #${scannedQRCodes.length} scanned successfully!-->
<!--          </div>-->
<!--        `;-->

<!--        if (scannedQRCodes.length === 4) {-->
          // Stop scanning
<!--          html5QrcodeScanner.clear();-->

<!--          document.getElementById('result').innerHTML = `-->
<!--            <div class="status-message status-complete">-->
<!--              üéâ All 4 QR codes scanned! Processing...-->
<!--            </div>-->
<!--          `;-->

          // Simulate saving to database
<!--          setTimeout(() => {-->
            // In your Flask app, replace this with actual fetch to /save endpoint
<!--            simulateSave();-->
<!--          }, 1000);-->

<!--        } else {-->
          // Continue scanning - reset message after 2 seconds
<!--          setTimeout(() => {-->
<!--            if (scannedQRCodes.length < 4) {-->
<!--              document.getElementById('result').innerHTML = `-->
<!--                <div class="status-message status-scanning">-->
<!--                  üì± Keep scanning! ${4 - scannedQRCodes.length} more codes needed.-->
<!--                </div>-->
<!--              `;-->
<!--            }-->
<!--          }, 2000);-->
<!--        }-->
<!--      } else {-->
        // Show duplicate message briefly
<!--        document.getElementById('result').innerHTML = `-->
<!--          <div class="status-message" style="background: #fef5e7; color: #d69e2e; border: 1px solid #f6e05e;">-->
<!--            ‚ö†Ô∏è QR Code already scanned. Try a different one.-->
<!--          </div>-->
<!--        `;-->

<!--        setTimeout(() => {-->
<!--          if (scannedQRCodes.length < 4) {-->
<!--            document.getElementById('result').innerHTML = `-->
<!--              <div class="status-message status-scanning">-->
<!--                üì± Keep scanning! ${4 - scannedQRCodes.length} more codes needed.-->
<!--              </div>-->
<!--            `;-->
<!--          }-->
<!--        }, 2000);-->
<!--      }-->
<!--    }-->

<!--    function onScanFailure(error) {-->
      // Handle scan failures silently - they're common during scanning
      // Only log significant errors
<!--      if (error.includes('NotReadableError') || error.includes('camera') || error.includes('Camera')) {-->
<!--        console.error('Camera error:', error);-->
<!--      }-->
<!--    }-->

    // Simulate saving to database (replace with actual fetch in Flask app)
<!--    function simulateSave() {-->
      // This simulates the Flask /save endpoint
      const success = Math.random() > 0.1; // 90% success rate for demo

<!--      if (success) {-->
<!--        document.getElementById('result').innerHTML = `-->
<!--          <div class="status-message status-complete">-->
<!--            <div style="margin-bottom: 10px;">üéâ Scanning Complete!</div>-->
<!--            <span class="status-badge status-success">‚úÖ Attendance marked successfully</span>-->
<!--          </div>-->
<!--        `;-->
<!--      } else {-->
<!--        document.getElementById('result').innerHTML = `-->
<!--          <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--            ‚ùå Failed to save attendance. Please try again.-->
<!--          </div>-->
<!--        `;-->
<!--      }-->
<!--    }-->

<!--    async function initializeScanner() {-->
<!--      try {-->
        // Check for camera support
<!--        const devices = await Html5Qrcode.getCameras();-->
<!--        console.log('Available cameras:', devices);-->

<!--        if (!devices || devices.length === 0) {-->
<!--          throw new Error('No cameras found');-->
<!--        }-->

        // Show loading message
<!--        document.getElementById('result').innerHTML = `-->
<!--          <div class="status-message status-scanning">-->
<!--            üé• Starting camera... Please grant permission when prompted.-->
<!--          </div>-->
<!--        `;-->

        // Configuration for the scanner
<!--        const config = {-->
<!--          fps: 10,-->
<!--          qrbox: { width: 250, height: 250 },-->
<!--          aspectRatio: 1.0,-->
<!--          rememberLastUsedCamera: true,-->
<!--          showTorchButtonIfSupported: true-->
<!--        };-->

        // Initialize scanner
<!--        html5QrcodeScanner = new Html5QrcodeScanner("reader", config, false);-->

        // Start scanning
<!--        html5QrcodeScanner.render(onScanSuccess, onScanFailure);-->

<!--        console.log('Scanner initialized successfully');-->

        // Update status after a short delay to ensure scanner is ready
<!--        setTimeout(() => {-->
<!--          document.getElementById('result').innerHTML = `-->
<!--            <div class="status-message status-scanning">-->
<!--              üì± Scanner is ready. Start scanning QR codes!-->
<!--            </div>-->
<!--          `;-->
<!--          updateProgress();-->
<!--        }, 1000);-->

<!--      } catch (error) {-->
<!--        console.error('Scanner initialization failed:', error);-->

<!--        let errorMessage = 'Failed to initialize scanner.';-->
<!--        if (error.name === 'NotAllowedError') {-->
<!--          errorMessage = 'Camera permission denied. Please allow camera access and refresh.';-->
<!--        } else if (error.name === 'NotFoundError') {-->
<!--          errorMessage = 'No camera found. Please connect a camera and refresh.';-->
<!--        } else if (error.name === 'NotReadableError') {-->
<!--          errorMessage = 'Camera is being used by another app. Please close other apps and refresh.';-->
<!--        } else if (error.message) {-->
<!--          errorMessage = error.message;-->
<!--        }-->

<!--        document.getElementById('result').innerHTML = `-->
<!--          <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--            ‚ùå ${errorMessage}<br><br>-->
<!--            <strong>Troubleshooting:</strong><br>-->
<!--            ‚Ä¢ Use HTTPS (not HTTP)<br>-->
<!--            ‚Ä¢ Grant camera permissions<br>-->
<!--            ‚Ä¢ Close other apps using camera<br>-->
<!--            ‚Ä¢ Try refreshing the page<br>-->
<!--            ‚Ä¢ Use Chrome or Firefox browser-->
<!--          </div>-->
<!--        `;-->
<!--      }-->
<!--    }-->

    // Initialize when page loads
<!--    window.addEventListener('load', initializeScanner);-->
<!--  </script>-->
<!--</body>-->
<!--</html>-->


<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>QR Scanner</title>-->
<!--  <script src="https://unpkg.com/html5-qrcode"></script>-->
<!--  <style>-->
<!--    * {-->
<!--      margin: 0;-->
<!--      padding: 0;-->
<!--      box-sizing: border-box;-->
<!--    }-->

<!--    body {-->
<!--      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;-->
<!--      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);-->
<!--      min-height: 100vh;-->
<!--      padding: 20px;-->
<!--      color: #333;-->
<!--    }-->

<!--    .container {-->
<!--      max-width: 400px;-->
<!--      margin: 0 auto;-->
<!--      background: rgba(255, 255, 255, 0.95);-->
<!--      border-radius: 20px;-->
<!--      padding: 25px;-->
<!--      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);-->
<!--      backdrop-filter: blur(10px);-->
<!--    }-->

<!--    h1 {-->
<!--      text-align: center;-->
<!--      color: #4a5568;-->
<!--      margin-bottom: 25px;-->
<!--      font-size: 28px;-->
<!--      font-weight: 700;-->
<!--    }-->

<!--    .scanner-container {-->
<!--      background: #f7fafc;-->
<!--      border-radius: 15px;-->
<!--      padding: 20px;-->
<!--      margin-bottom: 20px;-->
<!--      border: 2px dashed #e2e8f0;-->
<!--      transition: all 0.3s ease;-->
<!--    }-->

<!--    .scanner-container.active {-->
<!--      border-color: #48bb78;-->
<!--      box-shadow: 0 0 20px rgba(72, 187, 120, 0.2);-->
<!--    }-->

<!--    #reader {-->
<!--      width: 100% !important;-->
<!--      max-width: 300px;-->
<!--      margin: 0 auto;-->
<!--      border-radius: 10px;-->
<!--      overflow: hidden;-->
<!--    }-->

<!--    .progress-container {-->
<!--      background: #edf2f7;-->
<!--      border-radius: 10px;-->
<!--      padding: 15px;-->
<!--      margin-bottom: 15px;-->
<!--      text-align: center;-->
<!--    }-->

<!--    .progress-bar {-->
<!--      background: #e2e8f0;-->
<!--      height: 8px;-->
<!--      border-radius: 4px;-->
<!--      overflow: hidden;-->
<!--      margin: 10px 0;-->
<!--    }-->

<!--    .progress-fill {-->
<!--      background: linear-gradient(90deg, #48bb78, #38a169);-->
<!--      height: 100%;-->
<!--      transition: width 0.3s ease;-->
<!--      border-radius: 4px;-->
<!--    }-->

<!--    .qr-counter {-->
<!--      font-size: 18px;-->
<!--      font-weight: 600;-->
<!--      color: #4a5568;-->
<!--      margin-bottom: 5px;-->
<!--    }-->

<!--    .qr-dots {-->
<!--      display: flex;-->
<!--      justify-content: center;-->
<!--      gap: 10px;-->
<!--      margin-top: 15px;-->
<!--    }-->

<!--    .qr-dot {-->
<!--      width: 12px;-->
<!--      height: 12px;-->
<!--      border-radius: 50%;-->
<!--      background: #e2e8f0;-->
<!--      transition: all 0.3s ease;-->
<!--    }-->

<!--    .qr-dot.scanned {-->
<!--      background: #48bb78;-->
<!--      transform: scale(1.2);-->
<!--      box-shadow: 0 0 10px rgba(72, 187, 120, 0.5);-->
<!--    }-->

<!--    .status-message {-->
<!--      text-align: center;-->
<!--      padding: 15px;-->
<!--      border-radius: 10px;-->
<!--      margin-top: 15px;-->
<!--      font-weight: 500;-->
<!--    }-->

<!--    .status-scanning {-->
<!--      background: #e6fffa;-->
<!--      color: #38b2ac;-->
<!--      border: 1px solid #b2f5ea;-->
<!--    }-->

<!--    .status-complete {-->
<!--      background: #f0fff4;-->
<!--      color: #38a169;-->
<!--      border: 1px solid #9ae6b4;-->
<!--    }-->

<!--    .status-badge {-->
<!--      display: inline-block;-->
<!--      padding: 8px 16px;-->
<!--      border-radius: 20px;-->
<!--      font-size: 14px;-->
<!--      font-weight: 600;-->
<!--    }-->

<!--    .status-success {-->
<!--      background: #48bb78;-->
<!--      color: white;-->
<!--    }-->

<!--    .scanner-instructions {-->
<!--      text-align: center;-->
<!--      color: #718096;-->
<!--      font-size: 14px;-->
<!--      margin-bottom: 15px;-->
<!--      line-height: 1.5;-->
<!--    }-->

    /* Mobile optimizations */
<!--    @media (max-width: 480px) {-->
<!--      body {-->
<!--        padding: 10px;-->
<!--      }-->

<!--      .container {-->
<!--        padding: 20px;-->
<!--        border-radius: 15px;-->
<!--      }-->

<!--      h1 {-->
<!--        font-size: 24px;-->
<!--        margin-bottom: 20px;-->
<!--      }-->

<!--      #reader {-->
<!--        max-width: 100%;-->
<!--      }-->
<!--    }-->

    /* Hide QR scanner UI elements we don't need */
<!--    #reader__dashboard_section {-->
<!--      display: none !important;-->
<!--    }-->

<!--    #reader__header_message {-->
<!--      display: none !important;-->
<!--    }-->
<!--  </style>-->
<!--</head>-->
<!--<body>-->
<!--  <div class="container">-->
<!--    <h1>üîç QR Scanner</h1>-->

<!--    <div class="scanner-instructions">-->
<!--      Point your camera at QR codes to scan them. You need to scan 4 unique codes.-->
<!--    </div>-->

<!--    <div class="progress-container">-->
<!--      <div class="qr-counter">-->
<!--        <span id="scanned-count">0</span> / 4 QR Codes Scanned-->
<!--      </div>-->
<!--      <div class="progress-bar">-->
<!--        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>-->
<!--      </div>-->
<!--      <div class="qr-dots">-->
<!--        <div class="qr-dot" id="dot-1"></div>-->
<!--        <div class="qr-dot" id="dot-2"></div>-->
<!--        <div class="qr-dot" id="dot-3"></div>-->
<!--        <div class="qr-dot" id="dot-4"></div>-->
<!--      </div>-->
<!--    </div>-->

<!--    <div class="scanner-container" id="scanner-container">-->
<!--      <div id="reader"></div>-->
<!--    </div>-->

<!--    <div id="result">-->
<!--      <div class="status-message status-scanning">-->
<!--        üì± Scanner is ready. Start scanning QR codes!-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->

<!--  <script>-->
    // Get course_id from Flask template
<!--    const courseId = {{ course_id }};-->
<!--    console.log('Course ID from Flask template:', courseId);-->

<!--    let scannedQRCodes = [];-->
<!--    let html5QrcodeScanner;-->

<!--    function updateProgress() {-->
<!--      const count = scannedQRCodes.length;-->
<!--      const percentage = (count / 4) * 100;-->

<!--      document.getElementById('scanned-count').textContent = count;-->
<!--      document.getElementById('progress-fill').style.width = percentage + '%';-->

<!--      for (let i = 1; i <= 4; i++) {-->
<!--        const dot = document.getElementById(`dot-${i}`);-->
<!--        if (i <= count) {-->
<!--          dot.classList.add('scanned');-->
<!--        } else {-->
<!--          dot.classList.remove('scanned');-->
<!--        }-->
<!--      }-->

<!--      const scannerContainer = document.getElementById('scanner-container');-->
<!--      if (count > 0 && count < 4) {-->
<!--        scannerContainer.classList.add('active');-->
<!--      }-->
<!--    }-->

<!--    function onScanSuccess(decodedText, decodedResult) {-->
<!--      if (!scannedQRCodes.includes(decodedText)) {-->
<!--        scannedQRCodes.push(decodedText);-->
<!--        updateProgress();-->

<!--        if (scannedQRCodes.length === 4) {-->
<!--          html5QrcodeScanner.clear();-->

<!--          document.getElementById('result').innerHTML = `-->
<!--            <div class="status-message status-complete">-->
<!--              üéâ All 4 QR codes scanned! Saving to database...-->
<!--            </div>-->
<!--          `;-->

<!--          fetch('/save', {-->
<!--            method: 'POST',-->
<!--            headers: { 'Content-Type': 'application/json' },-->
<!--            body: JSON.stringify({-->
<!--              course_id: courseId,-->
<!--              qr_codes: scannedQRCodes,-->
<!--              data: scannedQRCodes.join('\n')-->
<!--            })-->
<!--          })-->
<!--          .then(response => response.text())-->
<!--          .then(data => {-->
<!--            const resultDiv = document.getElementById('result');-->
<!--            if (data === "Attendance marked successfully") {-->
<!--              resultDiv.innerHTML = `-->
<!--                <div class="status-message status-complete">-->
<!--                  <div style="margin-bottom: 10px;">üéâ Scanning Complete!</div>-->
<!--                  <span class="status-badge status-success">‚úÖ ${data}</span>-->
<!--                </div>-->
<!--              `;-->
<!--            } else {-->
<!--              resultDiv.innerHTML = `-->
<!--                <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--                  ‚ùå ${data}-->
<!--                </div>-->
<!--              `;-->
<!--            }-->
<!--          })-->
<!--          .catch(error => {-->
<!--            console.error('Error:', error);-->
<!--            document.getElementById('result').innerHTML = `-->
<!--              <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--                ‚ùå Network error. Please check your connection.-->
<!--              </div>-->
<!--            `;-->
<!--          });-->
<!--        }-->
<!--      }-->
<!--    }-->

<!--    function onScanFailure(error) {-->
      // Handle scan failures silently - they're common during scanning
      // But log camera errors for debugging
<!--      if (error.includes('NotReadableError') || error.includes('camera') || error.includes('Camera')) {-->
<!--        console.error('Camera error:', error);-->
<!--      }-->
<!--    }-->

<!--    async function checkCameraSupport() {-->
<!--      try {-->
        // Test camera access first
<!--        const stream = await navigator.mediaDevices.getUserMedia({ video: true });-->
        // Stop the test stream immediately
<!--        stream.getTracks().forEach(track => track.stop());-->

        // Then check for available cameras
<!--        const devices = await Html5Qrcode.getCameras();-->
<!--        console.log('Available cameras:', devices);-->

<!--        if (devices && devices.length > 0) {-->
<!--          return devices;-->
<!--        }-->
<!--        return false;-->
<!--      } catch (error) {-->
<!--        console.error('Camera check failed:', error);-->
<!--        return false;-->
<!--      }-->
<!--    }-->

<!--    window.onload = async function() {-->
<!--      try {-->
        // Check if camera is supported
<!--        const cameras = await checkCameraSupport();-->
<!--        if (!cameras) {-->
<!--          document.getElementById('result').innerHTML = `-->
<!--            <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--              ‚ùå No camera found or camera access denied.<br>-->
<!--              <small>Please ensure you have a camera connected and grant permission when prompted.</small>-->
<!--            </div>-->
<!--          `;-->
<!--          return;-->
<!--        }-->

        // Detect if mobile or desktop
<!--        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);-->
<!--        console.log('Device detected:', isMobile ? 'Mobile' : 'Desktop');-->
<!--        console.log('Number of cameras found:', cameras.length);-->

        // Show scanning status
<!--        document.getElementById('result').innerHTML = `-->
<!--          <div class="status-message status-scanning">-->
<!--            üé• Starting camera... Please wait-->
<!--          </div>-->
<!--        `;-->

        // Simpler configuration for desktop
<!--        let config;-->
<!--        if (isMobile) {-->
<!--          config = {-->
<!--            fps: 10,-->
<!--            qrbox: { width: 250, height: 250 },-->
<!--            aspectRatio: 1.0,-->
<!--            showTorchButtonIfSupported: true,-->
<!--            rememberLastUsedCamera: true-->
<!--          };-->
<!--        } else {-->
          // Desktop - more basic config
<!--          config = {-->
            fps: 8, // Lower FPS for desktop
            qrbox: 200, // Simpler qrbox
<!--            rememberLastUsedCamera: true,-->
            disableFlip: false // Allow camera flip
<!--          };-->
<!--        }-->

<!--        html5QrcodeScanner = new Html5QrcodeScanner("reader", config);-->

        // Add event listener for when scanner starts
<!--        html5QrcodeScanner.render(-->
<!--          onScanSuccess,-->
<!--          onScanFailure-->
<!--        ).then(() => {-->
<!--          console.log('Scanner started successfully');-->
<!--          document.getElementById('result').innerHTML = `-->
<!--            <div class="status-message status-scanning">-->
<!--              üì± Scanner is ready. Start scanning QR codes!-->
<!--            </div>-->
<!--          `;-->
<!--          updateProgress();-->
<!--        }).catch(error => {-->
<!--          console.error('Scanner render failed:', error);-->
<!--          document.getElementById('result').innerHTML = `-->
<!--            <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--              ‚ùå Camera failed to start: ${error.message}<br>-->
<!--              <small>Try:</small><br>-->
<!--              ‚Ä¢ Close other apps using camera<br>-->
<!--              ‚Ä¢ Refresh the page<br>-->
<!--              ‚Ä¢ Try Chrome browser-->
<!--            </div>-->
<!--          `;-->
<!--        });-->

<!--      } catch (error) {-->
<!--        console.error('Scanner initialization failed:', error);-->
<!--        document.getElementById('result').innerHTML = `-->
<!--          <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--            ‚ùå Failed to initialize scanner.<br>-->
<!--            <small>Error: ${error.message}</small><br>-->
<!--            <strong>Troubleshooting:</strong><br>-->
<!--            ‚Ä¢ Use HTTPS (not HTTP)<br>-->
<!--            ‚Ä¢ Grant camera permissions<br>-->
<!--            ‚Ä¢ Check if camera is being used by another app<br>-->
<!--            ‚Ä¢ Try refreshing the page<br>-->
<!--            ‚Ä¢ Try different browser (Chrome recommended)-->
<!--          </div>-->
<!--        `;-->
<!--      }-->
<!--    }-->
<!--  </script>-->
<!--</body>-->
<!--</html>-->








<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>QR Scanner</title>-->
<!--  <script src="https://unpkg.com/html5-qrcode"></script>-->
<!--  <style>-->
<!--    * {-->
<!--      margin: 0;-->
<!--      padding: 0;-->
<!--      box-sizing: border-box;-->
<!--    }-->

<!--    body {-->
<!--      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;-->
<!--      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);-->
<!--      min-height: 100vh;-->
<!--      padding: 20px;-->
<!--      color: #333;-->
<!--    }-->

<!--    .container {-->
<!--      max-width: 400px;-->
<!--      margin: 0 auto;-->
<!--      background: rgba(255, 255, 255, 0.95);-->
<!--      border-radius: 20px;-->
<!--      padding: 25px;-->
<!--      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);-->
<!--      backdrop-filter: blur(10px);-->
<!--    }-->

<!--    h1 {-->
<!--      text-align: center;-->
<!--      color: #4a5568;-->
<!--      margin-bottom: 25px;-->
<!--      font-size: 28px;-->
<!--      font-weight: 700;-->
<!--    }-->

<!--    .scanner-container {-->
<!--      background: #f7fafc;-->
<!--      border-radius: 15px;-->
<!--      padding: 20px;-->
<!--      margin-bottom: 20px;-->
<!--      border: 2px dashed #e2e8f0;-->
<!--      transition: all 0.3s ease;-->
<!--    }-->

<!--    .scanner-container.active {-->
<!--      border-color: #48bb78;-->
<!--      box-shadow: 0 0 20px rgba(72, 187, 120, 0.2);-->
<!--    }-->

<!--    #reader {-->
<!--      width: 100% !important;-->
<!--      max-width: 300px;-->
<!--      margin: 0 auto;-->
<!--      border-radius: 10px;-->
<!--      overflow: hidden;-->
<!--    }-->

<!--    .progress-container {-->
<!--      background: #edf2f7;-->
<!--      border-radius: 10px;-->
<!--      padding: 15px;-->
<!--      margin-bottom: 15px;-->
<!--      text-align: center;-->
<!--    }-->

<!--    .progress-bar {-->
<!--      background: #e2e8f0;-->
<!--      height: 8px;-->
<!--      border-radius: 4px;-->
<!--      overflow: hidden;-->
<!--      margin: 10px 0;-->
<!--    }-->

<!--    .progress-fill {-->
<!--      background: linear-gradient(90deg, #48bb78, #38a169);-->
<!--      height: 100%;-->
<!--      transition: width 0.3s ease;-->
<!--      border-radius: 4px;-->
<!--    }-->

<!--    .qr-counter {-->
<!--      font-size: 18px;-->
<!--      font-weight: 600;-->
<!--      color: #4a5568;-->
<!--      margin-bottom: 5px;-->
<!--    }-->

<!--    .qr-dots {-->
<!--      display: flex;-->
<!--      justify-content: center;-->
<!--      gap: 10px;-->
<!--      margin-top: 15px;-->
<!--    }-->

<!--    .qr-dot {-->
<!--      width: 12px;-->
<!--      height: 12px;-->
<!--      border-radius: 50%;-->
<!--      background: #e2e8f0;-->
<!--      transition: all 0.3s ease;-->
<!--    }-->

<!--    .qr-dot.scanned {-->
<!--      background: #48bb78;-->
<!--      transform: scale(1.2);-->
<!--      box-shadow: 0 0 10px rgba(72, 187, 120, 0.5);-->
<!--    }-->

<!--    .status-message {-->
<!--      text-align: center;-->
<!--      padding: 15px;-->
<!--      border-radius: 10px;-->
<!--      margin-top: 15px;-->
<!--      font-weight: 500;-->
<!--    }-->

<!--    .status-scanning {-->
<!--      background: #e6fffa;-->
<!--      color: #38b2ac;-->
<!--      border: 1px solid #b2f5ea;-->
<!--    }-->

<!--    .status-complete {-->
<!--      background: #f0fff4;-->
<!--      color: #38a169;-->
<!--      border: 1px solid #9ae6b4;-->
<!--    }-->

<!--    .status-badge {-->
<!--      display: inline-block;-->
<!--      padding: 8px 16px;-->
<!--      border-radius: 20px;-->
<!--      font-size: 14px;-->
<!--      font-weight: 600;-->
<!--    }-->

<!--    .status-success {-->
<!--      background: #48bb78;-->
<!--      color: white;-->
<!--    }-->

<!--    .scanner-instructions {-->
<!--      text-align: center;-->
<!--      color: #718096;-->
<!--      font-size: 14px;-->
<!--      margin-bottom: 15px;-->
<!--      line-height: 1.5;-->
<!--    }-->

    /* Mobile optimizations */
<!--    @media (max-width: 480px) {-->
<!--      body {-->
<!--        padding: 10px;-->
<!--      }-->

<!--      .container {-->
<!--        padding: 20px;-->
<!--        border-radius: 15px;-->
<!--      }-->

<!--      h1 {-->
<!--        font-size: 24px;-->
<!--        margin-bottom: 20px;-->
<!--      }-->

<!--      #reader {-->
<!--        max-width: 100%;-->
<!--      }-->
<!--    }-->

    /* Hide QR scanner UI elements we don't need */
<!--    #reader__dashboard_section {-->
<!--      display: none !important;-->
<!--    }-->

<!--    #reader__header_message {-->
<!--      display: none !important;-->
<!--    }-->
<!--  </style>-->
<!--</head>-->
<!--<body>-->
<!--  <div class="container">-->
<!--    <h1>üîç QR Scanner</h1>-->

<!--    <div class="scanner-instructions">-->
<!--      Point your camera at QR codes to scan them. You need to scan 4 unique codes.-->
<!--    </div>-->

<!--    <div class="progress-container">-->
<!--      <div class="qr-counter">-->
<!--        <span id="scanned-count">0</span> / 4 QR Codes Scanned-->
<!--      </div>-->
<!--      <div class="progress-bar">-->
<!--        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>-->
<!--      </div>-->
<!--      <div class="qr-dots">-->
<!--        <div class="qr-dot" id="dot-1"></div>-->
<!--        <div class="qr-dot" id="dot-2"></div>-->
<!--        <div class="qr-dot" id="dot-3"></div>-->
<!--        <div class="qr-dot" id="dot-4"></div>-->
<!--      </div>-->
<!--    </div>-->

<!--    <div class="scanner-container" id="scanner-container">-->
<!--      <div id="reader"></div>-->
<!--    </div>-->

<!--    <div id="result">-->
<!--      <div class="status-message status-scanning">-->
<!--        üì± Scanner is ready. Start scanning QR codes!-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->

<!--  <script>-->
<!--    let scannedQRCodes = [];-->
<!--    let html5QrcodeScanner;-->
<!--    let courseId = null;-->

<!--    async function getCourseId() {-->
<!--      try {-->
<!--        const response = await fetch('/get_course_id');-->
<!--        const data = await response.json();-->
<!--        courseId = data.course_id;-->
<!--      } catch (error) {-->
<!--        console.error('Error getting course ID:', error);-->
<!--      }-->
<!--    }-->

<!--    function updateProgress() {-->
<!--      const count = scannedQRCodes.length;-->
<!--      const percentage = (count / 4) * 100;-->

<!--      document.getElementById('scanned-count').textContent = count;-->
<!--      document.getElementById('progress-fill').style.width = percentage + '%';-->

<!--      for (let i = 1; i <= 4; i++) {-->
<!--        const dot = document.getElementById(`dot-${i}`);-->
<!--        if (i <= count) {-->
<!--          dot.classList.add('scanned');-->
<!--        } else {-->
<!--          dot.classList.remove('scanned');-->
<!--        }-->
<!--      }-->

<!--      const scannerContainer = document.getElementById('scanner-container');-->
<!--      if (count > 0 && count < 4) {-->
<!--        scannerContainer.classList.add('active');-->
<!--      }-->
<!--    }-->

<!--    function onScanSuccess(decodedText, decodedResult) {-->
<!--      if (!scannedQRCodes.includes(decodedText)) {-->
<!--        scannedQRCodes.push(decodedText);-->
<!--        updateProgress();-->

<!--        if (scannedQRCodes.length === 4) {-->
<!--          html5QrcodeScanner.clear();-->

<!--          document.getElementById('result').innerHTML = `-->
<!--            <div class="status-message status-complete">-->
<!--              üéâ All 4 QR codes scanned! Saving to database...-->
<!--            </div>-->
<!--          `;-->

<!--          fetch('/save', {-->
<!--            method: 'POST',-->
<!--            headers: { 'Content-Type': 'application/json' },-->
<!--            body: JSON.stringify({-->
<!--              course_id: courseId,-->
<!--              qr_codes: scannedQRCodes,-->
<!--              data: scannedQRCodes.join('\n')-->
<!--            })-->
<!--          })-->
<!--          .then(response => response.json())-->
<!--          .then(data => {-->
<!--            const resultDiv = document.getElementById('result');-->
<!--            if (data.success) {-->
<!--              resultDiv.innerHTML = `-->
<!--                <div class="status-message status-complete">-->
<!--                  <div style="margin-bottom: 10px;">üéâ Scanning Complete!</div>-->
<!--                  <span class="status-badge status-success">‚úÖ Successfully saved to database!</span>-->
<!--                </div>-->
<!--              `;-->
<!--            } else {-->
<!--              resultDiv.innerHTML = `-->
<!--                <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--                  ‚ùå Error saving to database. Please try again.-->
<!--                </div>-->
<!--              `;-->
<!--            }-->
<!--          })-->
<!--          .catch(error => {-->
<!--            console.error('Error:', error);-->
<!--            document.getElementById('result').innerHTML = `-->
<!--              <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--                ‚ùå Network error. Please check your connection.-->
<!--              </div>-->
<!--            `;-->
<!--          });-->
<!--        }-->
<!--      }-->
<!--    }-->

<!--    function onScanFailure(error) {-->
      // Handle scan failures silently - they're common during scanning
<!--    }-->

<!--    async function checkCameraSupport() {-->
<!--      try {-->
<!--        const devices = await Html5Qrcode.getCameras();-->
<!--        if (devices && devices.length > 0) {-->
<!--          return true;-->
<!--        }-->
<!--        return false;-->
<!--      } catch (error) {-->
<!--        console.error('Camera check failed:', error);-->
<!--        return false;-->
<!--      }-->
<!--    }-->

<!--    window.onload = async function() {-->
<!--      try {-->
        // Check if camera is supported
<!--        const cameraSupported = await checkCameraSupport();-->
<!--        if (!cameraSupported) {-->
<!--          document.getElementById('result').innerHTML = `-->
<!--            <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--              ‚ùå No camera found or camera access denied.<br>-->
<!--              <small>Please ensure you have a camera connected and grant permission when prompted.</small>-->
<!--            </div>-->
<!--          `;-->
<!--          return;-->
<!--        }-->

<!--        await getCourseId();-->

        // Detect if mobile or desktop
<!--        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);-->

        // Different configurations for mobile vs desktop
<!--        const config = {-->
<!--          fps: 10,-->
<!--          qrbox: { width: 250, height: 250 },-->
<!--          showTorchButtonIfSupported: true,-->
<!--          rememberLastUsedCamera: true,-->
<!--          supportedScanTypes: [Html5QrcodeScanType.SCAN_TYPE_CAMERA]-->
<!--        };-->

        // Only add mobile-specific constraints on mobile devices
<!--        if (isMobile) {-->
<!--          config.aspectRatio = 1.0;-->
<!--          config.videoConstraints = {-->
<!--            facingMode: "environment"-->
<!--          };-->
<!--        }-->

<!--        html5QrcodeScanner = new Html5QrcodeScanner("reader", config);-->
<!--        html5QrcodeScanner.render(onScanSuccess, onScanFailure);-->
<!--        updateProgress();-->

        // Show device type for debugging
<!--        console.log('Device detected:', isMobile ? 'Mobile' : 'Desktop');-->

<!--      } catch (error) {-->
<!--        console.error('Scanner initialization failed:', error);-->
<!--        document.getElementById('result').innerHTML = `-->
<!--          <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--            ‚ùå Failed to initialize scanner.<br>-->
<!--            <small>Error: ${error.message}</small><br>-->
<!--            <strong>Troubleshooting:</strong><br>-->
<!--            ‚Ä¢ Use HTTPS (not HTTP)<br>-->
<!--            ‚Ä¢ Grant camera permissions<br>-->
<!--            ‚Ä¢ Check if camera is being used by another app<br>-->
<!--            ‚Ä¢ Try refreshing the page<br>-->
<!--            ‚Ä¢ Try different browser (Chrome recommended)-->
<!--          </div>-->
<!--        `;-->
<!--      }-->
<!--    }-->
<!--  </script>-->
<!--</body>-->
<!--</html>-->




<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>QR Scanner</title>-->
<!--  <script src="https://unpkg.com/html5-qrcode"></script>-->
<!--  <style>-->
<!--    * {-->
<!--      margin: 0;-->
<!--      padding: 0;-->
<!--      box-sizing: border-box;-->
<!--    }-->

<!--    body {-->
<!--      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;-->
<!--      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);-->
<!--      min-height: 100vh;-->
<!--      padding: 20px;-->
<!--      color: #333;-->
<!--    }-->

<!--    .container {-->
<!--      max-width: 400px;-->
<!--      margin: 0 auto;-->
<!--      background: rgba(255, 255, 255, 0.95);-->
<!--      border-radius: 20px;-->
<!--      padding: 25px;-->
<!--      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);-->
<!--      backdrop-filter: blur(10px);-->
<!--    }-->

<!--    h1 {-->
<!--      text-align: center;-->
<!--      color: #4a5568;-->
<!--      margin-bottom: 25px;-->
<!--      font-size: 28px;-->
<!--      font-weight: 700;-->
<!--    }-->

<!--    .scanner-container {-->
<!--      background: #f7fafc;-->
<!--      border-radius: 15px;-->
<!--      padding: 20px;-->
<!--      margin-bottom: 20px;-->
<!--      border: 2px dashed #e2e8f0;-->
<!--      transition: all 0.3s ease;-->
<!--    }-->

<!--    .scanner-container.active {-->
<!--      border-color: #48bb78;-->
<!--      box-shadow: 0 0 20px rgba(72, 187, 120, 0.2);-->
<!--    }-->

<!--    #reader {-->
<!--      width: 100% !important;-->
<!--      max-width: 300px;-->
<!--      margin: 0 auto;-->
<!--      border-radius: 10px;-->
<!--      overflow: hidden;-->
<!--    }-->

<!--    .progress-container {-->
<!--      background: #edf2f7;-->
<!--      border-radius: 10px;-->
<!--      padding: 15px;-->
<!--      margin-bottom: 15px;-->
<!--      text-align: center;-->
<!--    }-->

<!--    .progress-bar {-->
<!--      background: #e2e8f0;-->
<!--      height: 8px;-->
<!--      border-radius: 4px;-->
<!--      overflow: hidden;-->
<!--      margin: 10px 0;-->
<!--    }-->

<!--    .progress-fill {-->
<!--      background: linear-gradient(90deg, #48bb78, #38a169);-->
<!--      height: 100%;-->
<!--      transition: width 0.3s ease;-->
<!--      border-radius: 4px;-->
<!--    }-->

<!--    .qr-counter {-->
<!--      font-size: 18px;-->
<!--      font-weight: 600;-->
<!--      color: #4a5568;-->
<!--      margin-bottom: 5px;-->
<!--    }-->

<!--    .qr-dots {-->
<!--      display: flex;-->
<!--      justify-content: center;-->
<!--      gap: 10px;-->
<!--      margin-top: 15px;-->
<!--    }-->

<!--    .qr-dot {-->
<!--      width: 12px;-->
<!--      height: 12px;-->
<!--      border-radius: 50%;-->
<!--      background: #e2e8f0;-->
<!--      transition: all 0.3s ease;-->
<!--    }-->

<!--    .qr-dot.scanned {-->
<!--      background: #48bb78;-->
<!--      transform: scale(1.2);-->
<!--      box-shadow: 0 0 10px rgba(72, 187, 120, 0.5);-->
<!--    }-->

<!--    .status-message {-->
<!--      text-align: center;-->
<!--      padding: 15px;-->
<!--      border-radius: 10px;-->
<!--      margin-top: 15px;-->
<!--      font-weight: 500;-->
<!--    }-->

<!--    .status-scanning {-->
<!--      background: #e6fffa;-->
<!--      color: #38b2ac;-->
<!--      border: 1px solid #b2f5ea;-->
<!--    }-->

<!--    .status-complete {-->
<!--      background: #f0fff4;-->
<!--      color: #38a169;-->
<!--      border: 1px solid #9ae6b4;-->
<!--    }-->

<!--    .status-badge {-->
<!--      display: inline-block;-->
<!--      padding: 8px 16px;-->
<!--      border-radius: 20px;-->
<!--      font-size: 14px;-->
<!--      font-weight: 600;-->
<!--    }-->

<!--    .status-success {-->
<!--      background: #48bb78;-->
<!--      color: white;-->
<!--    }-->

<!--    .scanner-instructions {-->
<!--      text-align: center;-->
<!--      color: #718096;-->
<!--      font-size: 14px;-->
<!--      margin-bottom: 15px;-->
<!--      line-height: 1.5;-->
<!--    }-->

    /* Mobile optimizations */
<!--    @media (max-width: 480px) {-->
<!--      body {-->
<!--        padding: 10px;-->
<!--      }-->

<!--      .container {-->
<!--        padding: 20px;-->
<!--        border-radius: 15px;-->
<!--      }-->

<!--      h1 {-->
<!--        font-size: 24px;-->
<!--        margin-bottom: 20px;-->
<!--      }-->

<!--      #reader {-->
<!--        max-width: 100%;-->
<!--      }-->
<!--    }-->

    /* Hide QR scanner UI elements we don't need */
<!--    #reader__dashboard_section {-->
<!--      display: none !important;-->
<!--    }-->

<!--    #reader__header_message {-->
<!--      display: none !important;-->
<!--    }-->
<!--  </style>-->
<!--</head>-->
<!--<body>-->
<!--  <div class="container">-->
<!--    <h1>üîç QR Scanner</h1>-->

<!--    <div class="scanner-instructions">-->
<!--      Point your camera at QR codes to scan them. You need to scan 4 unique codes.-->
<!--    </div>-->

<!--    <div class="progress-container">-->
<!--      <div class="qr-counter">-->
<!--        <span id="scanned-count">0</span> / 4 QR Codes Scanned-->
<!--      </div>-->
<!--      <div class="progress-bar">-->
<!--        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>-->
<!--      </div>-->
<!--      <div class="qr-dots">-->
<!--        <div class="qr-dot" id="dot-1"></div>-->
<!--        <div class="qr-dot" id="dot-2"></div>-->
<!--        <div class="qr-dot" id="dot-3"></div>-->
<!--        <div class="qr-dot" id="dot-4"></div>-->
<!--      </div>-->
<!--    </div>-->

<!--    <div class="scanner-container" id="scanner-container">-->
<!--      <div id="reader"></div>-->
<!--    </div>-->

<!--    <div id="result">-->
<!--      <div class="status-message status-scanning">-->
<!--        üì± Scanner is ready. Start scanning QR codes!-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->

<!--  <script>-->
<!--    let scannedQRCodes = [];-->
<!--    let html5QrcodeScanner;-->
<!--    let courseId = null;-->

<!--    async function getCourseId() {-->
<!--      try {-->
<!--        const response = await fetch('/get_course_id');-->
<!--        const data = await response.json();-->
<!--        courseId = data.course_id;-->
<!--      } catch (error) {-->
<!--        console.error('Error getting course ID:', error);-->
<!--      }-->
<!--    }-->

<!--    function updateProgress() {-->
<!--      const count = scannedQRCodes.length;-->
<!--      const percentage = (count / 4) * 100;-->

<!--      document.getElementById('scanned-count').textContent = count;-->
<!--      document.getElementById('progress-fill').style.width = percentage + '%';-->

<!--      for (let i = 1; i <= 4; i++) {-->
<!--        const dot = document.getElementById(`dot-${i}`);-->
<!--        if (i <= count) {-->
<!--          dot.classList.add('scanned');-->
<!--        } else {-->
<!--          dot.classList.remove('scanned');-->
<!--        }-->
<!--      }-->

<!--      const scannerContainer = document.getElementById('scanner-container');-->
<!--      if (count > 0 && count < 4) {-->
<!--        scannerContainer.classList.add('active');-->
<!--      }-->
<!--    }-->

<!--    function onScanSuccess(decodedText, decodedResult) {-->
<!--      if (!scannedQRCodes.includes(decodedText)) {-->
<!--        scannedQRCodes.push(decodedText);-->
<!--        updateProgress();-->

<!--        if (scannedQRCodes.length === 4) {-->
<!--          html5QrcodeScanner.clear();-->

<!--          document.getElementById('result').innerHTML = `-->
<!--            <div class="status-message status-complete">-->
<!--              üéâ All 4 QR codes scanned! Saving to database...-->
<!--            </div>-->
<!--          `;-->

<!--          fetch('/save', {-->
<!--            method: 'POST',-->
<!--            headers: { 'Content-Type': 'application/json' },-->
<!--            body: JSON.stringify({-->
<!--              course_id: courseId,-->
<!--              qr_codes: scannedQRCodes,-->
<!--              data: scannedQRCodes.join('\n')-->
<!--            })-->
<!--          })-->
<!--          .then(response => response.json())-->
<!--          .then(data => {-->
<!--            const resultDiv = document.getElementById('result');-->
<!--            if (data.success) {-->
<!--              resultDiv.innerHTML = `-->
<!--                <div class="status-message status-complete">-->
<!--                  <div style="margin-bottom: 10px;">üéâ Scanning Complete!</div>-->
<!--                  <span class="status-badge status-success">‚úÖ Successfully saved to database!</span>-->
<!--                </div>-->
<!--              `;-->
<!--            } else {-->
<!--              resultDiv.innerHTML = `-->
<!--                <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--                  ‚ùå Error saving to database. Please try again.-->
<!--                </div>-->
<!--              `;-->
<!--            }-->
<!--          })-->
<!--          .catch(error => {-->
<!--            console.error('Error:', error);-->
<!--            document.getElementById('result').innerHTML = `-->
<!--              <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--                ‚ùå Network error. Please check your connection.-->
<!--              </div>-->
<!--            `;-->
<!--          });-->
<!--        }-->
<!--      }-->
<!--    }-->

<!--    function onScanFailure(error) {-->
      // Handle scan failures silently - they're common during scanning
<!--    }-->

<!--    async function checkCameraSupport() {-->
<!--      try {-->
<!--        const devices = await Html5Qrcode.getCameras();-->
<!--        if (devices && devices.length > 0) {-->
<!--          return true;-->
<!--        }-->
<!--        return false;-->
<!--      } catch (error) {-->
<!--        console.error('Camera check failed:', error);-->
<!--        return false;-->
<!--      }-->
<!--    }-->

<!--    window.onload = async function() {-->
<!--      try {-->
        // Check if camera is supported
<!--        const cameraSupported = await checkCameraSupport();-->
<!--        if (!cameraSupported) {-->
<!--          document.getElementById('result').innerHTML = `-->
<!--            <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--              ‚ùå No camera found or camera access denied.<br>-->
<!--              <small>Please ensure you have a camera connected and grant permission when prompted.</small>-->
<!--            </div>-->
<!--          `;-->
<!--          return;-->
<!--        }-->

<!--        await getCourseId();-->

        // Create scanner with better error handling
<!--        html5QrcodeScanner = new Html5QrcodeScanner(-->
<!--          "reader", {-->
<!--            fps: 10,-->
<!--            qrbox: { width: 250, height: 250 },-->
<!--            aspectRatio: 1.0,-->
<!--            showTorchButtonIfSupported: true,-->
<!--            rememberLastUsedCamera: true,-->
<!--            supportedScanTypes: [Html5QrcodeScanType.SCAN_TYPE_CAMERA]-->
<!--          }-->
<!--        );-->

<!--        html5QrcodeScanner.render(onScanSuccess, onScanFailure);-->
<!--        updateProgress();-->

<!--      } catch (error) {-->
<!--        console.error('Scanner initialization failed:', error);-->
<!--        document.getElementById('result').innerHTML = `-->
<!--          <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--            ‚ùå Failed to initialize scanner.<br>-->
<!--            <small>Error: ${error.message}</small><br>-->
<!--            <strong>Troubleshooting:</strong><br>-->
<!--            ‚Ä¢ Use HTTPS (not HTTP)<br>-->
<!--            ‚Ä¢ Grant camera permissions<br>-->
<!--            ‚Ä¢ Check if camera is being used by another app-->
<!--          </div>-->
<!--        `;-->
<!--      }-->
<!--    }-->
<!--  </script>-->
<!--</body>-->
<!--</html>-->


<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>QR Scanner</title>-->
<!--  <script src="https://unpkg.com/html5-qrcode"></script>-->
<!--  <style>-->
<!--    * {-->
<!--      margin: 0;-->
<!--      padding: 0;-->
<!--      box-sizing: border-box;-->
<!--    }-->

<!--    body {-->
<!--      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;-->
<!--      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);-->
<!--      min-height: 100vh;-->
<!--      padding: 20px;-->
<!--      color: #333;-->
<!--    }-->

<!--    .container {-->
<!--      max-width: 400px;-->
<!--      margin: 0 auto;-->
<!--      background: rgba(255, 255, 255, 0.95);-->
<!--      border-radius: 20px;-->
<!--      padding: 25px;-->
<!--      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);-->
<!--      backdrop-filter: blur(10px);-->
<!--    }-->

<!--    h1 {-->
<!--      text-align: center;-->
<!--      color: #4a5568;-->
<!--      margin-bottom: 25px;-->
<!--      font-size: 28px;-->
<!--      font-weight: 700;-->
<!--    }-->

<!--    .scanner-container {-->
<!--      background: #f7fafc;-->
<!--      border-radius: 15px;-->
<!--      padding: 20px;-->
<!--      margin-bottom: 20px;-->
<!--      border: 2px dashed #e2e8f0;-->
<!--      transition: all 0.3s ease;-->
<!--    }-->

<!--    .scanner-container.active {-->
<!--      border-color: #48bb78;-->
<!--      box-shadow: 0 0 20px rgba(72, 187, 120, 0.2);-->
<!--    }-->

<!--    #reader {-->
<!--      width: 100% !important;-->
<!--      max-width: 300px;-->
<!--      margin: 0 auto;-->
<!--      border-radius: 10px;-->
<!--      overflow: hidden;-->
<!--    }-->

<!--    .progress-container {-->
<!--      background: #edf2f7;-->
<!--      border-radius: 10px;-->
<!--      padding: 15px;-->
<!--      margin-bottom: 15px;-->
<!--      text-align: center;-->
<!--    }-->

<!--    .progress-bar {-->
<!--      background: #e2e8f0;-->
<!--      height: 8px;-->
<!--      border-radius: 4px;-->
<!--      overflow: hidden;-->
<!--      margin: 10px 0;-->
<!--    }-->

<!--    .progress-fill {-->
<!--      background: linear-gradient(90deg, #48bb78, #38a169);-->
<!--      height: 100%;-->
<!--      transition: width 0.3s ease;-->
<!--      border-radius: 4px;-->
<!--    }-->

<!--    .qr-counter {-->
<!--      font-size: 18px;-->
<!--      font-weight: 600;-->
<!--      color: #4a5568;-->
<!--      margin-bottom: 5px;-->
<!--    }-->

<!--    .qr-dots {-->
<!--      display: flex;-->
<!--      justify-content: center;-->
<!--      gap: 10px;-->
<!--      margin-top: 15px;-->
<!--    }-->

<!--    .qr-dot {-->
<!--      width: 12px;-->
<!--      height: 12px;-->
<!--      border-radius: 50%;-->
<!--      background: #e2e8f0;-->
<!--      transition: all 0.3s ease;-->
<!--    }-->

<!--    .qr-dot.scanned {-->
<!--      background: #48bb78;-->
<!--      transform: scale(1.2);-->
<!--      box-shadow: 0 0 10px rgba(72, 187, 120, 0.5);-->
<!--    }-->

<!--    .status-message {-->
<!--      text-align: center;-->
<!--      padding: 15px;-->
<!--      border-radius: 10px;-->
<!--      margin-top: 15px;-->
<!--      font-weight: 500;-->
<!--    }-->

<!--    .status-scanning {-->
<!--      background: #e6fffa;-->
<!--      color: #38b2ac;-->
<!--      border: 1px solid #b2f5ea;-->
<!--    }-->

<!--    .status-complete {-->
<!--      background: #f0fff4;-->
<!--      color: #38a169;-->
<!--      border: 1px solid #9ae6b4;-->
<!--    }-->

<!--    .status-badge {-->
<!--      display: inline-block;-->
<!--      padding: 8px 16px;-->
<!--      border-radius: 20px;-->
<!--      font-size: 14px;-->
<!--      font-weight: 600;-->
<!--    }-->

<!--    .status-success {-->
<!--      background: #48bb78;-->
<!--      color: white;-->
<!--    }-->

<!--    .scanner-instructions {-->
<!--      text-align: center;-->
<!--      color: #718096;-->
<!--      font-size: 14px;-->
<!--      margin-bottom: 15px;-->
<!--      line-height: 1.5;-->
<!--    }-->

    /* Mobile optimizations */
<!--    @media (max-width: 480px) {-->
<!--      body {-->
<!--        padding: 10px;-->
<!--      }-->

<!--      .container {-->
<!--        padding: 20px;-->
<!--        border-radius: 15px;-->
<!--      }-->

<!--      h1 {-->
<!--        font-size: 24px;-->
<!--        margin-bottom: 20px;-->
<!--      }-->

<!--      #reader {-->
<!--        max-width: 100%;-->
<!--      }-->
<!--    }-->

    /* Hide QR scanner UI elements we don't need */
<!--    #reader__dashboard_section {-->
<!--      display: none !important;-->
<!--    }-->

<!--    #reader__header_message {-->
<!--      display: none !important;-->
<!--    }-->
<!--  </style>-->
<!--</head>-->
<!--<body>-->
<!--  <div class="container">-->
<!--    <h1>üîç QR Scanner</h1>-->

<!--    <div class="scanner-instructions">-->
<!--      Point your camera at QR codes to scan them. You need to scan 4 unique codes.-->
<!--    </div>-->

<!--    <div class="progress-container">-->
<!--      <div class="qr-counter">-->
<!--        <span id="scanned-count">0</span> / 4 QR Codes Scanned-->
<!--      </div>-->
<!--      <div class="progress-bar">-->
<!--        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>-->
<!--      </div>-->
<!--      <div class="qr-dots">-->
<!--        <div class="qr-dot" id="dot-1"></div>-->
<!--        <div class="qr-dot" id="dot-2"></div>-->
<!--        <div class="qr-dot" id="dot-3"></div>-->
<!--        <div class="qr-dot" id="dot-4"></div>-->
<!--      </div>-->
<!--    </div>-->

<!--    <div class="scanner-container" id="scanner-container">-->
<!--      <div id="reader"></div>-->
<!--    </div>-->

<!--    <div id="result">-->
<!--      <div class="status-message status-scanning">-->
<!--        üì± Scanner is ready. Start scanning QR codes!-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->

<!--  <script>-->
<!--    let scannedQRCodes = [];-->
<!--    let html5QrcodeScanner;-->
<!--    let courseId = null;-->

<!--    async function getCourseId() {-->
<!--      try {-->
<!--        const response = await fetch('/get_course_id');-->
<!--        const data = await response.json();-->
<!--        courseId = data.course_id;-->
<!--      } catch (error) {-->
<!--        console.error('Error getting course ID:', error);-->
<!--      }-->
<!--    }-->

<!--    function updateProgress() {-->
<!--      const count = scannedQRCodes.length;-->
<!--      const percentage = (count / 4) * 100;-->

<!--      document.getElementById('scanned-count').textContent = count;-->
<!--      document.getElementById('progress-fill').style.width = percentage + '%';-->

<!--      for (let i = 1; i <= 4; i++) {-->
<!--        const dot = document.getElementById(`dot-${i}`);-->
<!--        if (i <= count) {-->
<!--          dot.classList.add('scanned');-->
<!--        } else {-->
<!--          dot.classList.remove('scanned');-->
<!--        }-->
<!--      }-->

<!--      const scannerContainer = document.getElementById('scanner-container');-->
<!--      if (count > 0 && count < 4) {-->
<!--        scannerContainer.classList.add('active');-->
<!--      }-->
<!--    }-->

<!--    function onScanSuccess(decodedText, decodedResult) {-->
<!--      if (!scannedQRCodes.includes(decodedText)) {-->
<!--        scannedQRCodes.push(decodedText);-->
<!--        updateProgress();-->

<!--        if (scannedQRCodes.length === 4) {-->
<!--          html5QrcodeScanner.clear();-->

<!--          document.getElementById('result').innerHTML = `-->
<!--            <div class="status-message status-complete">-->
<!--              üéâ All 4 QR codes scanned! Saving to database...-->
<!--            </div>-->
<!--          `;-->

<!--          fetch('/save', {-->
<!--            method: 'POST',-->
<!--            headers: { 'Content-Type': 'application/json' },-->
<!--            body: JSON.stringify({-->
<!--              course_id: courseId,-->
<!--              qr_codes: scannedQRCodes,-->
<!--              data: scannedQRCodes.join('\n')-->
<!--            })-->
<!--          })-->
<!--          .then(response => response.json())-->
<!--          .then(data => {-->
<!--            const resultDiv = document.getElementById('result');-->
<!--            if (data.success) {-->
<!--              resultDiv.innerHTML = `-->
<!--                <div class="status-message status-complete">-->
<!--                  <div style="margin-bottom: 10px;">üéâ Scanning Complete!</div>-->
<!--                  <span class="status-badge status-success">‚úÖ Successfully saved to database!</span>-->
<!--                </div>-->
<!--              `;-->
<!--            } else {-->
<!--              resultDiv.innerHTML = `-->
<!--                <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--                  ‚ùå Error saving to database. Please try again.-->
<!--                </div>-->
<!--              `;-->
<!--            }-->
<!--          })-->
<!--          .catch(error => {-->
<!--            console.error('Error:', error);-->
<!--            document.getElementById('result').innerHTML = `-->
<!--              <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--                ‚ùå Network error. Please check your connection.-->
<!--              </div>-->
<!--            `;-->
<!--          });-->
<!--        }-->
<!--      }-->
<!--    }-->

<!--    window.onload = async function() {-->
<!--      await getCourseId();-->

<!--      html5QrcodeScanner = new Html5QrcodeScanner(-->
<!--        "reader", {-->
<!--          fps: 10,-->
<!--          qrbox: { width: 250, height: 250 },-->
<!--          aspectRatio: 1.0,-->
<!--          showTorchButtonIfSupported: true-->
<!--        }-->
<!--      );-->

<!--      html5QrcodeScanner.render(onScanSuccess);-->
<!--      updateProgress();-->
<!--    }-->
<!--  </script>-->
<!--</body>-->
<!--</html>-->


<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>QR Scanner</title>-->
<!--  <script src="https://unpkg.com/html5-qrcode"></script>-->
<!--  <style>-->
<!--    * {-->
<!--      margin: 0;-->
<!--      padding: 0;-->
<!--      box-sizing: border-box;-->
<!--    }-->

<!--    body {-->
<!--      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;-->
<!--      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);-->
<!--      min-height: 100vh;-->
<!--      padding: 20px;-->
<!--      color: #333;-->
<!--    }-->

<!--    .container {-->
<!--      max-width: 400px;-->
<!--      margin: 0 auto;-->
<!--      background: rgba(255, 255, 255, 0.95);-->
<!--      border-radius: 20px;-->
<!--      padding: 25px;-->
<!--      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);-->
<!--      backdrop-filter: blur(10px);-->
<!--    }-->

<!--    h1 {-->
<!--      text-align: center;-->
<!--      color: #4a5568;-->
<!--      margin-bottom: 25px;-->
<!--      font-size: 28px;-->
<!--      font-weight: 700;-->
<!--    }-->

<!--    .scanner-container {-->
<!--      background: #f7fafc;-->
<!--      border-radius: 15px;-->
<!--      padding: 20px;-->
<!--      margin-bottom: 20px;-->
<!--      border: 2px dashed #e2e8f0;-->
<!--      transition: all 0.3s ease;-->
<!--    }-->

<!--    .scanner-container.active {-->
<!--      border-color: #48bb78;-->
<!--      box-shadow: 0 0 20px rgba(72, 187, 120, 0.2);-->
<!--    }-->

<!--    #reader {-->
<!--      width: 100% !important;-->
<!--      max-width: 300px;-->
<!--      margin: 0 auto;-->
<!--      border-radius: 10px;-->
<!--      overflow: hidden;-->
<!--    }-->

<!--    .progress-container {-->
<!--      background: #edf2f7;-->
<!--      border-radius: 10px;-->
<!--      padding: 15px;-->
<!--      margin-bottom: 15px;-->
<!--      text-align: center;-->
<!--    }-->

<!--    .progress-bar {-->
<!--      background: #e2e8f0;-->
<!--      height: 8px;-->
<!--      border-radius: 4px;-->
<!--      overflow: hidden;-->
<!--      margin: 10px 0;-->
<!--    }-->

<!--    .progress-fill {-->
<!--      background: linear-gradient(90deg, #48bb78, #38a169);-->
<!--      height: 100%;-->
<!--      transition: width 0.3s ease;-->
<!--      border-radius: 4px;-->
<!--    }-->

<!--    .qr-counter {-->
<!--      font-size: 18px;-->
<!--      font-weight: 600;-->
<!--      color: #4a5568;-->
<!--      margin-bottom: 5px;-->
<!--    }-->

<!--    .qr-dots {-->
<!--      display: flex;-->
<!--      justify-content: center;-->
<!--      gap: 10px;-->
<!--      margin-top: 15px;-->
<!--    }-->

<!--    .qr-dot {-->
<!--      width: 12px;-->
<!--      height: 12px;-->
<!--      border-radius: 50%;-->
<!--      background: #e2e8f0;-->
<!--      transition: all 0.3s ease;-->
<!--    }-->

<!--    .qr-dot.scanned {-->
<!--      background: #48bb78;-->
<!--      transform: scale(1.2);-->
<!--      box-shadow: 0 0 10px rgba(72, 187, 120, 0.5);-->
<!--    }-->

<!--    .status-message {-->
<!--      text-align: center;-->
<!--      padding: 15px;-->
<!--      border-radius: 10px;-->
<!--      margin-top: 15px;-->
<!--      font-weight: 500;-->
<!--    }-->

<!--    .status-scanning {-->
<!--      background: #e6fffa;-->
<!--      color: #38b2ac;-->
<!--      border: 1px solid #b2f5ea;-->
<!--    }-->

<!--    .status-complete {-->
<!--      background: #f0fff4;-->
<!--      color: #38a169;-->
<!--      border: 1px solid #9ae6b4;-->
<!--    }-->

<!--    .status-badge {-->
<!--      display: inline-block;-->
<!--      padding: 8px 16px;-->
<!--      border-radius: 20px;-->
<!--      font-size: 14px;-->
<!--      font-weight: 600;-->
<!--    }-->

<!--    .status-success {-->
<!--      background: #48bb78;-->
<!--      color: white;-->
<!--    }-->

<!--    .scanner-instructions {-->
<!--      text-align: center;-->
<!--      color: #718096;-->
<!--      font-size: 14px;-->
<!--      margin-bottom: 15px;-->
<!--      line-height: 1.5;-->
<!--    }-->

    /* Mobile optimizations */
<!--    @media (max-width: 480px) {-->
<!--      body {-->
<!--        padding: 10px;-->
<!--      }-->

<!--      .container {-->
<!--        padding: 20px;-->
<!--        border-radius: 15px;-->
<!--      }-->

<!--      h1 {-->
<!--        font-size: 24px;-->
<!--        margin-bottom: 20px;-->
<!--      }-->

<!--      #reader {-->
<!--        max-width: 100%;-->
<!--      }-->
<!--    }-->

    /* Hide QR scanner UI elements we don't need */
<!--    #reader__dashboard_section {-->
<!--      display: none !important;-->
<!--    }-->

<!--    #reader__header_message {-->
<!--      display: none !important;-->
<!--    }-->
<!--  </style>-->
<!--</head>-->
<!--<body>-->
<!--  <div class="container">-->
<!--    <h1>üîç QR Scanner</h1>-->

<!--    <div class="scanner-instructions">-->
<!--      Point your camera at QR codes to scan them. You need to scan 4 unique codes.-->
<!--    </div>-->

<!--    <div class="progress-container">-->
<!--      <div class="qr-counter">-->
<!--        <span id="scanned-count">0</span> / 4 QR Codes Scanned-->
<!--      </div>-->
<!--      <div class="progress-bar">-->
<!--        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>-->
<!--      </div>-->
<!--      <div class="qr-dots">-->
<!--        <div class="qr-dot" id="dot-1"></div>-->
<!--        <div class="qr-dot" id="dot-2"></div>-->
<!--        <div class="qr-dot" id="dot-3"></div>-->
<!--        <div class="qr-dot" id="dot-4"></div>-->
<!--      </div>-->
<!--    </div>-->

<!--    <div class="scanner-container" id="scanner-container">-->
<!--      <div id="reader"></div>-->
<!--    </div>-->

<!--    <div id="result">-->
<!--      <div class="status-message status-scanning">-->
<!--        üì± Scanner is ready. Start scanning QR codes!-->
<!--      </div>-->
<!--    </div>-->
<!--  </div>-->

<!--  <script>-->
<!--    let scannedQRCodes = [];-->
<!--    let html5QrcodeScanner;-->
    let courseId = null; // This should be set by your backend

    // Get course_id from backend (you'll need to implement this)
<!--    async function getCourseId() {-->
<!--      try {-->
<!--        const response = await fetch('/get_course_id');-->
<!--        const data = await response.json();-->
<!--        courseId = data.course_id;-->
<!--      } catch (error) {-->
<!--        console.error('Error getting course ID:', error);-->
<!--      }-->
<!--    }-->

<!--    function updateProgress() {-->
<!--      const count = scannedQRCodes.length;-->
<!--      const percentage = (count / 4) * 100;-->

      // Update counter
<!--      document.getElementById('scanned-count').textContent = count;-->

      // Update progress bar
<!--      document.getElementById('progress-fill').style.width = percentage + '%';-->

      // Update dots
<!--      for (let i = 1; i <= 4; i++) {-->
<!--        const dot = document.getElementById(`dot-${i}`);-->
<!--        if (i <= count) {-->
<!--          dot.classList.add('scanned');-->
<!--        } else {-->
<!--          dot.classList.remove('scanned');-->
<!--        }-->
<!--      }-->

      // Update scanner container visual state
<!--      const scannerContainer = document.getElementById('scanner-container');-->
<!--      if (count > 0 && count < 4) {-->
<!--        scannerContainer.classList.add('active');-->
<!--      }-->
<!--    }-->

<!--    function onScanSuccess(decodedText, decodedResult) {-->
      // Don't show decoded text in UI, just process it
<!--      if (!scannedQRCodes.includes(decodedText)) {-->
<!--        scannedQRCodes.push(decodedText);-->
<!--        updateProgress();-->

<!--        if (scannedQRCodes.length === 4) {-->
          // Stop the scanner
<!--          html5QrcodeScanner.clear();-->

          // Update UI to show completion
<!--          document.getElementById('result').innerHTML = `-->
<!--            <div class="status-message status-complete">-->
<!--              üéâ All 4 QR codes scanned! Saving to database...-->
<!--            </div>-->
<!--          `;-->

          // Send data to backend
<!--          fetch('/save', {-->
<!--            method: 'POST',-->
<!--            headers: { 'Content-Type': 'application/json' },-->
<!--            body: JSON.stringify({-->
<!--              course_id: courseId,-->
<!--              qr_codes: scannedQRCodes,-->
<!--              data: scannedQRCodes.join('\n')-->
<!--            })-->
<!--          })-->
<!--          .then(response => response.json())-->
<!--          .then(data => {-->
<!--            const resultDiv = document.getElementById('result');-->
<!--            if (data.success) {-->
<!--              resultDiv.innerHTML = `-->
<!--                <div class="status-message status-complete">-->
<!--                  <div style="margin-bottom: 10px;">üéâ Scanning Complete!</div>-->
<!--                  <span class="status-badge status-success">‚úÖ Successfully saved to database!</span>-->
<!--                </div>-->
<!--              `;-->
<!--            } else {-->
<!--              resultDiv.innerHTML = `-->
<!--                <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--                  ‚ùå Error saving to database. Please try again.-->
<!--                </div>-->
<!--              `;-->
<!--            }-->
<!--          })-->
<!--          .catch(error => {-->
<!--            console.error('Error:', error);-->
<!--            document.getElementById('result').innerHTML = `-->
<!--              <div class="status-message" style="background: #fed7d7; color: #c53030; border: 1px solid #feb2b2;">-->
<!--                ‚ùå Network error. Please check your connection.-->
<!--              </div>-->
<!--            `;-->
<!--          });-->
<!--        }-->
<!--      }-->
<!--    }-->

<!--    window.onload = async function() {-->
      // Get course ID from backend first
<!--      await getCourseId();-->

      // Initialize scanner
<!--      html5QrcodeScanner = new Html5QrcodeScanner(-->
<!--        "reader", {-->
<!--          fps: 10,-->
<!--          qrbox: { width: 250, height: 250 },-->
<!--          aspectRatio: 1.0,-->
<!--          showTorchButtonIfSupported: true-->
<!--        }-->
<!--      );-->

<!--      html5QrcodeScanner.render(onScanSuccess);-->
<!--      updateProgress();-->
<!--    }-->
<!--  </script>-->
<!--</body>-->
<!--</html>-->





<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>Multi QR Scanner</title>-->
<!--  <script src="https://cdn.jsdelivr.net/npm/qr-scanner@1.4.2/qr-scanner.umd.min.js"></script>-->
<!--  <style>-->
<!--    body { font-family: Arial, sans-serif; text-align: center; margin: 20px; }-->
<!--    video { width: 80%; max-width: 400px; border: 2px solid #333; border-radius: 10px; margin-top: 10px; }-->
<!--    #result { margin-top: 15px; font-size: 1.1em; font-weight: bold; color: green; white-space: pre-line; }-->
<!--    #error { margin-top: 15px; font-size: 1.1em; color: red; }-->
<!--    button { padding: 10px 15px; margin: 5px; border: none; border-radius: 8px; cursor: pointer; }-->
<!--    .start { background-color: #4CAF50; color: white; }-->
<!--    .stop { background-color: #f44336; color: white; }-->
<!--  </style>-->
<!--</head>-->
<!--<body>-->

<!--  <h2>Multi QR Scanner (Up to 4 unique)</h2>-->

<!--  <div>-->
<!--    <button class="start" onclick="startCamera()">Start Camera</button>-->
<!--    <button class="stop" onclick="stopCamera()">Stop Camera</button>-->
<!--  </div>-->

<!--  <video id="video"></video>-->
<!--  <div id="result"></div>-->
<!--  <div id="error"></div>-->

<!--  <script>-->
<!--    let qrScanner;-->
    let scannedQRCodes = new Set();  // to store unique QR codes
<!--    const videoElement = document.getElementById('video');-->
<!--    const resultElement = document.getElementById('result');-->
<!--    const errorElement = document.getElementById('error');-->

    // Flask variable
<!--    const courseId = "{{ course_id }}";-->

<!--    function showError(msg) {-->
<!--      errorElement.textContent = msg;-->
<!--    }-->

<!--    function updateResults() {-->
<!--      resultElement.textContent = "Scanned (" + scannedQRCodes.size + "/4):\n" +-->
<!--        Array.from(scannedQRCodes).join("\n");-->
<!--    }-->

<!--    async function checkSupport() {-->
<!--      if (typeof QrScanner === 'undefined') {-->
<!--        showError("QR Scanner library failed to load.");-->
<!--        return false;-->
<!--      }-->
<!--      try {-->
<!--        const hasCam = await QrScanner.hasCamera();-->
<!--        if (!hasCam) {-->
<!--          showError("No camera found on this device.");-->
<!--          return false;-->
<!--        }-->
<!--      } catch (err) {-->
<!--        showError("Error checking camera: " + err.message);-->
<!--        return false;-->
<!--      }-->
<!--      return true;-->
<!--    }-->

<!--    async function startCamera() {-->
<!--      scannedQRCodes.clear();-->
<!--      updateResults();-->
<!--      errorElement.textContent = "";-->

<!--      const ok = await checkSupport();-->
<!--      if (!ok) return;-->

<!--      qrScanner = new QrScanner(videoElement, result => {-->
<!--        if (!scannedQRCodes.has(result) && scannedQRCodes.size < 4) {-->
<!--          scannedQRCodes.add(result);-->
<!--          updateResults();-->

<!--          if (scannedQRCodes.size === 4) {-->
            // ‚úÖ send to backend when 4 unique QR codes are collected
<!--            fetch("/save", {-->
<!--              method: "POST",-->
<!--              headers: { "Content-Type": "application/json" },-->
<!--              body: JSON.stringify({-->
<!--                course_id: courseId,-->
<!--                qr_codes: Array.from(scannedQRCodes),-->
<!--                data: Array.from(scannedQRCodes).join("\n")-->
<!--              })-->
<!--            })-->
<!--            .then(res => res.json())-->
<!--            .then(data => console.log("Saved:", data))-->
<!--            .catch(err => console.error("Save error:", err));-->

            stopCamera(); // stop scanning after 4 codes
<!--          }-->
<!--        }-->
<!--      }, { highlightScanRegion: true, highlightCodeOutline: true });-->

<!--      try {-->
<!--        await qrScanner.start();-->
<!--        videoElement.style.display = 'block';-->
<!--      } catch (err) {-->
<!--        showError("Camera access denied or unavailable: " + err.message);-->
<!--      }-->
<!--    }-->

<!--    function stopCamera() {-->
<!--      if (qrScanner) {-->
<!--        qrScanner.stop();-->
<!--        qrScanner.destroy();-->
<!--        qrScanner = null;-->
<!--        videoElement.style.display = 'none';-->
<!--      }-->
<!--    }-->
<!--  </script>-->
<!--</body>-->
<!--</html>-->





<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>QR Scanner</title>-->
<!--  <script src="https://cdnjs.cloudflare.com/ajax/libs/qr-scanner/1.4.2/qr-scanner.umd.min.js"></script>-->
<!--  <style>-->
<!--    * {-->
<!--      margin: 0;-->
<!--      padding: 0;-->
<!--      box-sizing: border-box;-->
<!--    }-->

<!--    body {-->
<!--      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;-->
<!--      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);-->
<!--      min-height: 100vh;-->
<!--      padding: 20px;-->
<!--      color: #333;-->
<!--    }-->

<!--    .scanner-container {-->
<!--      max-width: 600px;-->
<!--      margin: 0 auto;-->
<!--      background: rgba(255, 255, 255, 0.95);-->
<!--      backdrop-filter: blur(10px);-->
<!--      border-radius: 20px;-->
<!--      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);-->
<!--      overflow: hidden;-->
<!--    }-->

<!--    .header {-->
<!--      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);-->
<!--      color: white;-->
<!--      padding: 30px;-->
<!--      text-align: center;-->
<!--      position: relative;-->
<!--    }-->

<!--    .header::before {-->
<!--      content: '';-->
<!--      position: absolute;-->
<!--      top: 0;-->
<!--      left: 0;-->
<!--      right: 0;-->
<!--      bottom: 0;-->
<!--      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="qr-pattern" width="20" height="20" patternUnits="userSpaceOnUse"><rect width="20" height="20" fill="none"/><rect x="2" y="2" width="4" height="4" fill="white" opacity="0.1"/><rect x="14" y="14" width="4" height="4" fill="white" opacity="0.1"/><rect x="8" y="8" width="2" height="2" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23qr-pattern)"/></svg>');-->
<!--      pointer-events: none;-->
<!--    }-->

<!--    .header h1 {-->
<!--      font-size: 2.2em;-->
<!--      font-weight: 300;-->
<!--      margin-bottom: 10px;-->
<!--      position: relative;-->
<!--      z-index: 1;-->
<!--    }-->

<!--    .course-highlight {-->
<!--      color: #FFD700;-->
<!--      font-weight: 600;-->
<!--      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);-->
<!--    }-->

<!--    .scanner-section {-->
<!--      padding: 40px;-->
<!--      text-align: center;-->
<!--    }-->

<!--    .scanner-wrapper {-->
<!--      background: #f8f9fa;-->
<!--      border-radius: 15px;-->
<!--      padding: 20px;-->
<!--      margin-bottom: 30px;-->
<!--      border: 3px dashed #667eea;-->
<!--      transition: all 0.3s ease;-->
<!--      position: relative;-->
<!--      min-height: 320px;-->
<!--      display: flex;-->
<!--      align-items: center;-->
<!--      justify-content: center;-->
<!--    }-->

<!--    .scanner-wrapper.scanning {-->
<!--      border-color: #4facfe;-->
<!--      background: #f0f8ff;-->
<!--      box-shadow: 0 0 20px rgba(79, 172, 254, 0.2);-->
<!--    }-->

<!--    #videoElement {-->
<!--      width: 100%;-->
<!--      max-width: 320px;-->
<!--      border-radius: 10px;-->
<!--      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);-->
<!--    }-->

<!--    #result {-->
<!--      background: white;-->
<!--      border-radius: 15px;-->
<!--      padding: 25px;-->
<!--      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);-->
<!--      border-left: 5px solid #667eea;-->
<!--      text-align: left;-->
<!--      line-height: 1.6;-->
<!--    }-->

<!--    .progress-bar {-->
<!--      background: #e9ecef;-->
<!--      border-radius: 10px;-->
<!--      height: 8px;-->
<!--      margin: 20px 0;-->
<!--      overflow: hidden;-->
<!--    }-->

<!--    .progress-fill {-->
<!--      background: linear-gradient(90deg, #4facfe, #00f2fe);-->
<!--      height: 100%;-->
<!--      border-radius: 10px;-->
<!--      transition: width 0.5s ease;-->
<!--      width: 0%;-->
<!--    }-->

<!--    .progress-text {-->
<!--      font-size: 0.9em;-->
<!--      color: #666;-->
<!--      text-align: center;-->
<!--      margin-top: 10px;-->
<!--    }-->

<!--    .status-badge {-->
<!--      display: inline-block;-->
<!--      padding: 6px 12px;-->
<!--      border-radius: 20px;-->
<!--      font-size: 0.85em;-->
<!--      font-weight: 500;-->
<!--      margin: 5px 0;-->
<!--    }-->

<!--    .status-scanning {-->
<!--      background: #fff3cd;-->
<!--      color: #856404;-->
<!--      border: 1px solid #ffeeba;-->
<!--    }-->

<!--    .status-complete {-->
<!--      background: #d1edff;-->
<!--      color: #0c5460;-->
<!--      border: 1px solid #bee5eb;-->
<!--    }-->

<!--    .status-success {-->
<!--      background: #d4edda;-->
<!--      color: #155724;-->
<!--      border: 1px solid #c3e6cb;-->
<!--    }-->

<!--    .status-error {-->
<!--      background: #f8d7da;-->
<!--      color: #721c24;-->
<!--      border: 1px solid #f5c6cb;-->
<!--    }-->

<!--    .scanner-info {-->
<!--      background: #e3f2fd;-->
<!--      border-radius: 10px;-->
<!--      padding: 15px;-->
<!--      margin-bottom: 20px;-->
<!--      border-left: 4px solid #2196f3;-->
<!--    }-->

<!--    .scanner-info h3 {-->
<!--      color: #1976d2;-->
<!--      margin-bottom: 8px;-->
<!--      font-size: 1.1em;-->
<!--    }-->

<!--    .scanner-info p {-->
<!--      color: #666;-->
<!--      font-size: 0.9em;-->
<!--      margin: 0;-->
<!--    }-->

<!--    .qr-icon {-->
<!--      font-size: 2em;-->
<!--      margin-bottom: 15px;-->
<!--      opacity: 0.3;-->
<!--    }-->

<!--    .loading-animation {-->
<!--      display: inline-block;-->
<!--      width: 20px;-->
<!--      height: 20px;-->
<!--      border: 2px solid #f3f3f3;-->
<!--      border-top: 2px solid #667eea;-->
<!--      border-radius: 50%;-->
<!--      animation: spin 1s linear infinite;-->
<!--      margin-left: 10px;-->
<!--    }-->

<!--    .error-message {-->
<!--      color: #721c24;-->
<!--      background: #f8d7da;-->
<!--      padding: 15px;-->
<!--      border-radius: 8px;-->
<!--      margin: 15px 0;-->
<!--      border: 1px solid #f5c6cb;-->
<!--    }-->

<!--    .retry-btn, .start-btn {-->
<!--      background: #667eea;-->
<!--      color: white;-->
<!--      border: none;-->
<!--      padding: 12px 24px;-->
<!--      border-radius: 8px;-->
<!--      cursor: pointer;-->
<!--      font-size: 16px;-->
<!--      margin: 10px;-->
<!--      transition: background 0.3s ease;-->
<!--    }-->

<!--    .retry-btn:hover, .start-btn:hover {-->
<!--      background: #5a6fd8;-->
<!--    }-->

<!--    .stop-btn {-->
<!--      background: #dc3545;-->
<!--      color: white;-->
<!--      border: none;-->
<!--      padding: 12px 24px;-->
<!--      border-radius: 8px;-->
<!--      cursor: pointer;-->
<!--      font-size: 16px;-->
<!--      margin: 10px;-->
<!--      transition: background 0.3s ease;-->
<!--    }-->

<!--    .stop-btn:hover {-->
<!--      background: #c82333;-->
<!--    }-->

<!--    @keyframes spin {-->
<!--      0% { transform: rotate(0deg); }-->
<!--      100% { transform: rotate(360deg); }-->
<!--    }-->

<!--    .fade-in {-->
<!--      animation: fadeIn 0.6s ease-out;-->
<!--    }-->

<!--    @keyframes fadeIn {-->
<!--      from {-->
<!--        opacity: 0;-->
<!--        transform: translateY(20px);-->
<!--      }-->
<!--      to {-->
<!--        opacity: 1;-->
<!--        transform: translateY(0);-->
<!--      }-->
<!--    }-->

<!--    @media (max-width: 768px) {-->
<!--      body {-->
<!--        padding: 10px;-->
<!--      }-->

<!--      .scanner-container {-->
<!--        margin: 0;-->
<!--        border-radius: 15px;-->
<!--      }-->

<!--      .header {-->
<!--        padding: 20px 15px;-->
<!--      }-->

<!--      .header h1 {-->
<!--        font-size: 1.6em;-->
<!--        line-height: 1.2;-->
<!--      }-->

<!--      .scanner-section {-->
<!--        padding: 20px 15px;-->
<!--      }-->

<!--      .scanner-wrapper {-->
<!--        padding: 10px;-->
<!--        min-height: 250px;-->
<!--      }-->

<!--      #videoElement {-->
<!--        max-width: 100%;-->
<!--        width: 280px;-->
<!--      }-->

<!--      .progress-text {-->
<!--        font-size: 0.8em;-->
<!--      }-->

<!--      .start-btn, .stop-btn, .retry-btn {-->
<!--        padding: 10px 20px;-->
<!--        font-size: 14px;-->
<!--        margin: 8px 5px;-->
<!--      }-->

<!--      .camera-selection select {-->
<!--        min-width: 180px;-->
<!--        font-size: 13px;-->
<!--      }-->

<!--      #result {-->
<!--        padding: 20px 15px;-->
<!--      }-->

<!--      .status-badge {-->
<!--        font-size: 0.8em;-->
<!--        padding: 5px 10px;-->
<!--      }-->

<!--      .scanner-info {-->
<!--        padding: 12px;-->
<!--      }-->

<!--      .scanner-info h3 {-->
<!--        font-size: 1em;-->
<!--      }-->

<!--      .scanner-info p {-->
<!--        font-size: 0.85em;-->
<!--      }-->
<!--    }-->

    /* Extra small mobile devices */
<!--    @media (max-width: 480px) {-->
<!--      .header h1 {-->
<!--        font-size: 1.4em;-->
<!--      }-->

<!--      .scanner-section {-->
<!--        padding: 15px 10px;-->
<!--      }-->

<!--      #videoElement {-->
<!--        width: 240px;-->
<!--        max-width: 100%;-->
<!--      }-->

<!--      .scanner-wrapper {-->
<!--        min-height: 200px;-->
<!--        padding: 8px;-->
<!--      }-->

<!--      .controls {-->
<!--        margin: 10px 0;-->
<!--      }-->

<!--      .start-btn, .stop-btn, .retry-btn {-->
<!--        padding: 8px 16px;-->
<!--        font-size: 13px;-->
<!--        margin: 5px 3px;-->
<!--      }-->

<!--      .camera-selection {-->
<!--        margin: 10px 0;-->
<!--      }-->

<!--      .camera-selection select {-->
<!--        min-width: 150px;-->
<!--        font-size: 12px;-->
<!--        padding: 6px 10px;-->
<!--      }-->

<!--      .progress-text {-->
<!--        font-size: 0.75em;-->
<!--      }-->

<!--      .status-badge {-->
<!--        font-size: 0.75em;-->
<!--        padding: 4px 8px;-->
<!--      }-->
<!--    }-->

    /* Landscape mobile orientation */
<!--    @media (max-width: 768px) and (orientation: landscape) {-->
<!--      .header {-->
<!--        padding: 15px;-->
<!--      }-->

<!--      .header h1 {-->
<!--        font-size: 1.5em;-->
<!--      }-->

<!--      .scanner-section {-->
<!--        padding: 15px;-->
<!--      }-->

<!--      .scanner-wrapper {-->
<!--        min-height: 200px;-->
<!--      }-->

<!--      #videoElement {-->
<!--        width: 300px;-->
<!--        max-width: 90vw;-->
<!--      }-->
<!--    }-->

<!--    .camera-selection {-->
<!--      margin: 15px 0;-->
<!--    }-->

<!--    .camera-selection select {-->
<!--      padding: 8px 12px;-->
<!--      border-radius: 8px;-->
<!--      border: 2px solid #ddd;-->
<!--      font-size: 14px;-->
<!--      background: white;-->
<!--      min-width: 200px;-->
<!--    }-->

<!--    .controls {-->
<!--      margin: 15px 0;-->
<!--    }-->
<!--  </style>-->
<!--</head>-->
<!--<body>-->
<!--  <div class="scanner-container fade-in">-->
<!--    <div class="header">-->
<!--      <h1>üîç QR Scanner - Course <span class="course-highlight" id="course-display">{{ course_id }}</span></h1>-->
<!--    </div>-->

<!--    <div class="scanner-section">-->
<!--      <div class="scanner-info">-->
<!--        <h3>üìã Instructions</h3>-->
<!--        <p>Click "Start Camera" to begin scanning. Position QR codes within the camera view. The scanner will automatically detect and save unique codes (4 required).</p>-->
<!--      </div>-->

<!--      <div class="camera-selection" id="camera-selection" style="display: none;">-->
<!--        <label for="camera-select">üì∑ Select Camera: </label>-->
<!--        <select id="camera-select"></select>-->
<!--      </div>-->

<!--      <div class="controls">-->
<!--        <button class="start-btn" id="start-btn" onclick="startCamera()">üì∑ Start Camera</button>-->
<!--        <button class="stop-btn" id="stop-btn" onclick="stopCamera()" style="display: none;">‚èπÔ∏è Stop Camera</button>-->
<!--      </div>-->

<!--      <div class="scanner-wrapper" id="scanner-wrapper">-->
<!--        <video id="videoElement" autoplay playsinline style="display: none;"></video>-->
<!--        <div id="placeholder-message">-->
<!--          <div class="qr-icon">üì±</div>-->
<!--          <p>Click "Start Camera" to begin scanning</p>-->
<!--        </div>-->
<!--      </div>-->

<!--      <div class="progress-bar">-->
<!--        <div class="progress-fill" id="progress-fill"></div>-->
<!--      </div>-->
<!--      <div class="progress-text" id="progress-text">Ready to scan - 0/4 codes detected</div>-->

<!--      <div id="result"></div>-->
<!--    </div>-->
<!--  </div>-->

<!--  <script>-->
<!--    let scannedQRCodes = [];-->
<!--    let qrScanner = null;-->
    const courseId = {{ course_id }}; // Flask template variable
<!--    let isScanning = false;-->

<!--    function showError(message) {-->
<!--      const scannerWrapper = document.getElementById('scanner-wrapper');-->
<!--      scannerWrapper.innerHTML = `-->
<!--        <div class="error-message">-->
<!--          <h3>‚ùå Camera Error</h3>-->
<!--          <p>${message}</p>-->
<!--          <button class="retry-btn" onclick="startCamera()">üîÑ Retry Camera</button>-->
<!--        </div>-->
<!--      `;-->
<!--    }-->

<!--    function updateProgress() {-->
<!--      const progressFill = document.getElementById('progress-fill');-->
<!--      const progressText = document.getElementById('progress-text');-->
<!--      const scannerWrapper = document.getElementById('scanner-wrapper');-->

<!--      const percentage = (scannedQRCodes.length / 4) * 100;-->
<!--      progressFill.style.width = percentage + '%';-->

<!--      if (scannedQRCodes.length === 0) {-->
<!--        progressText.innerHTML = 'Ready to scan - 0/4 codes detected';-->
<!--        scannerWrapper.classList.remove('scanning');-->
<!--      } else if (scannedQRCodes.length < 4) {-->
<!--        progressText.innerHTML = `Scanning in progress - ${scannedQRCodes.length}/4 codes detected`;-->
<!--        scannerWrapper.classList.add('scanning');-->
<!--      } else {-->
<!--        progressText.innerHTML = 'Scanning complete! ‚úÖ';-->
<!--        scannerWrapper.classList.remove('scanning');-->
<!--      }-->
<!--    }-->

<!--    function updateScannedList() {-->
<!--      const resultDiv = document.getElementById('result');-->
<!--      if (scannedQRCodes.length === 0) {-->
<!--        resultDiv.innerHTML = `-->
<!--          <div style="text-align: center;">-->
<!--            <div class="qr-icon">üì±</div>-->
<!--            <p><strong>Course ID:</strong> ${courseId}</p>-->
<!--            <p style="color: #666; font-size: 0.9em; margin-top: 10px;">No QR codes scanned yet. Start camera and point at QR codes to begin.</p>-->
<!--          </div>-->
<!--        `;-->
<!--      } else {-->
<!--        const statusBadge = scannedQRCodes.length < 4-->
<!--          ? '<span class="status-badge status-scanning">üîÑ Scanning...</span>'-->
<!--          : '<span class="status-badge status-complete">‚úÖ Complete</span>';-->

<!--        resultDiv.innerHTML = `-->
<!--          <div style="text-align: center;">-->
<!--            <strong>üìã Course ID:</strong> ${courseId} ${statusBadge}-->
<!--            <div class="qr-list">-->
<!--              <strong>üéØ Scanned QR Codes: ${scannedQRCodes.length}/4</strong>-->
<!--              <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 15px; max-width: 200px; margin-left: auto; margin-right: auto;">-->
<!--                ${Array.from({length: 4}, (_, index) =>-->
<!--                  `<div style="width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.2em; ${-->
<!--                    index < scannedQRCodes.length-->
<!--                      ? 'background: #d4edda; color: #155724; border: 2px solid #28a745;'-->
<!--                      : 'background: #f8f9fa; color: #6c757d; border: 2px dashed #dee2e6;'-->
<!--                  }">-->
<!--                    ${index < scannedQRCodes.length ? '‚úÖ' : '‚≠ï'}-->
<!--                  </div>`-->
<!--                ).join('')}-->
<!--              </div>-->
<!--              ${scannedQRCodes.length > 0 ? '<div style="margin-top: 15px; font-size: 0.9em; color: #666;"><strong>Scanned codes:</strong><br>' + scannedQRCodes.map(code => `<code style="background: #f8f9fa; padding: 2px 6px; border-radius: 4px; margin: 2px;">${code.substring(0, 20)}${code.length > 20 ? '...' : ''}</code>`).join(' ') + '</div>' : ''}-->
<!--            </div>-->
<!--          </div>-->
<!--        `;-->
<!--      }-->
<!--      updateProgress();-->
<!--    }-->

<!--    async function populateCameraList() {-->
<!--      try {-->
<!--        const cameras = await QrScanner.listCameras(true);-->
<!--        const cameraSelect = document.getElementById('camera-select');-->
<!--        const cameraSelection = document.getElementById('camera-selection');-->

<!--        if (cameras.length > 1) {-->
<!--          cameraSelection.style.display = 'block';-->
<!--          cameraSelect.innerHTML = '';-->
<!--          cameras.forEach((camera, index) => {-->
<!--            const option = document.createElement('option');-->
<!--            option.value = camera.id;-->
<!--            option.text = camera.label || `Camera ${index + 1}`;-->
<!--            cameraSelect.appendChild(option);-->
<!--          });-->
<!--        }-->
<!--        return cameras;-->
<!--      } catch (error) {-->
<!--        console.log('Could not list cameras:', error);-->
<!--        return [];-->
<!--      }-->
<!--    }-->

<!--    async function startCamera() {-->
<!--      try {-->
<!--        const videoElement = document.getElementById('videoElement');-->
<!--        const placeholderMessage = document.getElementById('placeholder-message');-->
<!--        const startBtn = document.getElementById('start-btn');-->
<!--        const stopBtn = document.getElementById('stop-btn');-->

<!--        startBtn.disabled = true;-->
<!--        startBtn.innerHTML = '‚è≥ Starting...';-->

        // Populate camera list
<!--        await populateCameraList();-->

        // Create QR Scanner with mobile-optimized settings
<!--        qrScanner = new QrScanner(-->
<!--          videoElement,-->
<!--          result => {-->
<!--            console.log('QR Code detected:', result.data);-->
<!--            handleQRCode(result.data);-->
<!--          },-->
<!--          {-->
<!--            onDecodeError: error => {-->
              // Ignore decode errors - they happen during normal scanning
<!--              console.log('Decode attempt:', error);-->
<!--            },-->
<!--            highlightScanRegion: true,-->
<!--            highlightCodeOutline: true,-->
            maxScansPerSecond: 3, // Reduced for mobile performance
            preferredCamera: 'environment', // Use back camera on mobile
<!--          }-->
<!--        );-->

        // For mobile, try to use back camera by default
<!--        const cameraSelect = document.getElementById('camera-select');-->
<!--        if (cameraSelect.options.length > 0) {-->
          // Look for back camera
<!--          for (let i = 0; i < cameraSelect.options.length; i++) {-->
<!--            if (cameraSelect.options[i].text.toLowerCase().includes('back') ||-->
<!--                cameraSelect.options[i].text.toLowerCase().includes('environment')) {-->
<!--              await qrScanner.setCamera(cameraSelect.options[i].value);-->
<!--              cameraSelect.selectedIndex = i;-->
<!--              break;-->
<!--            }-->
<!--          }-->
<!--        }-->

        // Start scanning
<!--        await qrScanner.start();-->

        // Update UI
<!--        placeholderMessage.style.display = 'none';-->
<!--        videoElement.style.display = 'block';-->
<!--        startBtn.style.display = 'none';-->
<!--        stopBtn.style.display = 'inline-block';-->
<!--        isScanning = true;-->

<!--        console.log('Camera started successfully');-->

<!--      } catch (error) {-->
<!--        console.error('Error starting camera:', error);-->

<!--        let errorMessage = "Failed to access camera. ";-->
<!--        if (error.name === 'NotAllowedError') {-->
<!--          errorMessage += "Please grant camera permission and try again.";-->
<!--        } else if (error.name === 'NotFoundError') {-->
<!--          errorMessage += "No camera found on this device.";-->
<!--        } else if (error.name === 'NotSupportedError') {-->
<!--          errorMessage += "Your browser doesn't support camera access. Please use Chrome, Firefox, or Safari.";-->
<!--        } else {-->
<!--          errorMessage += error.message || "Unknown error occurred.";-->
<!--        }-->

<!--        showError(errorMessage);-->

        // Reset button
<!--        const startBtn = document.getElementById('start-btn');-->
<!--        startBtn.disabled = false;-->
<!--        startBtn.innerHTML = 'üì∑ Start Camera';-->
<!--      }-->
<!--    }-->

<!--    function stopCamera() {-->
<!--      if (qrScanner) {-->
<!--        qrScanner.stop();-->
<!--        qrScanner.destroy();-->
<!--        qrScanner = null;-->
<!--      }-->

<!--      const videoElement = document.getElementById('videoElement');-->
<!--      const placeholderMessage = document.getElementById('placeholder-message');-->
<!--      const startBtn = document.getElementById('start-btn');-->
<!--      const stopBtn = document.getElementById('stop-btn');-->

<!--      videoElement.style.display = 'none';-->
<!--      placeholderMessage.style.display = 'block';-->
<!--      placeholderMessage.innerHTML = `-->
<!--        <div class="qr-icon">üì±</div>-->
<!--        <p>Camera stopped. Click "Start Camera" to resume scanning.</p>-->
<!--      `;-->

<!--      startBtn.style.display = 'inline-block';-->
<!--      startBtn.disabled = false;-->
<!--      startBtn.innerHTML = 'üì∑ Start Camera';-->
<!--      stopBtn.style.display = 'none';-->
<!--      isScanning = false;-->
<!--    }-->

<!--    function handleQRCode(qrData) {-->
<!--      if (!scannedQRCodes.includes(qrData)) {-->
<!--        scannedQRCodes.push(qrData);-->
<!--        updateScannedList();-->

        // Play a beep sound (optional)
<!--        try {-->
<!--          const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LFeSMFl7/e7W03DCx3x+vhqFYRbLXp6zg2Ci2Py+jnp1oQa7jr6jU5CyKEzubgq1URbLnx6zU5CyeBxuXnqlYRabrx7Ds7CyaEwOPjr1AQaLXn6TQ8CyKAw+WisFARbLHl6DI+DCqAv+OislQRaK/k5TE+DSaAu+OktFUSaKnf5y8/Dy2AveKksVQUb6zl5j1ACiR9vuOstVsSa6nf4jZBDSh+wubksF0kZ6nc4TVCDSeCxO3lt1srYaTc4zxECih/w+vjtlwrcKfh4zxGCyd8ue7ltV4sYqPa5DZIDA2Byu3lw2UdBDWR3PLVhzwIiMHo6KdYEGWs5Ow4NwgkfcHq6K1hFGqu5O08NwgkfcHp6K5iEWmv4eM8OwgkfMDn6LdaEWqt4eM8Owgjf8Dp6LNaEWqt4Oo8OQckeL/p47NdEWmy4uo8OggigL3o4rNdEWmx4+o8OggihL/l4rZaE2mv4es9Owgjg8Dn4LRcF2as4es/PQYK');-->
<!--          audio.play().catch(e => console.log('Could not play sound'));-->
<!--        } catch (e) {-->
          // Audio playback failed, ignore
<!--        }-->

<!--        if (scannedQRCodes.length === 4) {-->
<!--          stopCamera();-->
<!--          document.getElementById('result').innerHTML += `-->
<!--            <div style="margin-top: 20px; text-align: center;">-->
<!--              <span class="status-badge status-complete">üéâ Scanning complete! Saving data...</span>-->
<!--              <div class="loading-animation"></div>-->
<!--            </div>-->
<!--          `;-->

          // Send all 4 codes and course ID to backend
<!--          fetch('/save', {-->
<!--            method: 'POST',-->
<!--            headers: { 'Content-Type': 'application/json' },-->
<!--            body: JSON.stringify({-->
<!--              course_id: courseId,-->
<!--              qr_codes: scannedQRCodes,-->
<!--              data: scannedQRCodes.join('\n')-->
<!--            })-->
<!--          })-->
<!--          .then(response => response.json())-->
<!--          .then(data => {-->
<!--            const resultDiv = document.getElementById('result');-->
<!--            if (data.success) {-->
<!--              resultDiv.innerHTML += `-->
<!--                <div style="margin-top: 15px; text-align: center;">-->
<!--                  <span class="status-badge status-success">‚úÖ Successfully saved to database!</span>-->
<!--                </div>-->
<!--              `;-->
<!--            } else {-->
<!--              resultDiv.innerHTML += `-->
<!--                <div style="margin-top: 15px; text-align: center;">-->
<!--                  <span class="status-badge status-error">‚ùå Error saving data: ${data.error}</span>-->
<!--                </div>-->
<!--              `;-->
<!--            }-->
<!--          })-->
<!--          .catch(error => {-->
<!--            console.error('Error:', error);-->
<!--            const resultDiv = document.getElementById('result');-->
<!--            resultDiv.innerHTML += `-->
<!--              <div style="margin-top: 15px; text-align: center;">-->
<!--                <span class="status-badge status-error">‚ùå Network error occurred!</span>-->
<!--              </div>-->
<!--            `;-->
<!--          });-->
<!--        }-->
<!--      }-->
<!--    }-->

    // Check for QR Scanner support
<!--    function checkSupport() {-->
<!--      if (typeof QrScanner === 'undefined') {-->
<!--        showError('QR Scanner library failed to load. Please refresh the page or try a different browser.');-->
<!--        return false;-->
<!--      }-->

<!--      if (!QrScanner.hasCamera()) {-->
<!--        showError('No camera found on this device or camera access is not supported.');-->
<!--        return false;-->
<!--      }-->

<!--      return true;-->
<!--    }-->

    // Handle camera selection change
<!--    document.getElementById('camera-select').addEventListener('change', async function() {-->
<!--      if (qrScanner && isScanning) {-->
<!--        try {-->
<!--          await qrScanner.setCamera(this.value);-->
<!--        } catch (error) {-->
<!--          console.error('Error switching camera:', error);-->
<!--        }-->
<!--      }-->
<!--    });-->

    // Prevent zoom on double tap for mobile
<!--    let lastTouchEnd = 0;-->
<!--    document.addEventListener('touchend', function (event) {-->
<!--      var now = (new Date()).getTime();-->
<!--      if (now - lastTouchEnd <= 300) {-->
<!--        event.preventDefault();-->
<!--      }-->
<!--      lastTouchEnd = now;-->
<!--    }, false);-->

    // Handle orientation change on mobile
<!--    window.addEventListener('orientationchange', function() {-->
<!--      if (qrScanner && isScanning) {-->
<!--        setTimeout(() => {-->
<!--          try {-->
<!--            qrScanner.stop();-->
<!--            qrScanner.start();-->
<!--          } catch (error) {-->
<!--            console.error('Error handling orientation change:', error);-->
<!--          }-->
<!--        }, 500);-->
<!--      }-->
<!--    });-->

    // Initialize when page loads
<!--    window.addEventListener('load', function() {-->
<!--      updateScannedList();-->

      // Wait a moment for library to load
<!--      setTimeout(() => {-->
<!--        checkSupport();-->
<!--      }, 1000);-->
<!--    });-->

    // Handle page visibility changes
<!--    document.addEventListener('visibilitychange', function() {-->
<!--      if (document.visibilityState === 'hidden' && isScanning) {-->
        // Page hidden, pause scanning
<!--        if (qrScanner) {-->
<!--          qrScanner.stop();-->
<!--        }-->
<!--      } else if (document.visibilityState === 'visible' && qrScanner) {-->
        // Page visible again, resume scanning
<!--        qrScanner.start().catch(console.error);-->
<!--      }-->
<!--    });-->
<!--  </script>-->
<!--</body>-->
<!--</html>-->





<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>QR Scanner</title>-->
<!--  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">-->
<!--  <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>-->
<!--  <style>-->
<!--    * {-->
<!--      margin: 0;-->
<!--      padding: 0;-->
<!--      box-sizing: border-box;-->
<!--    }-->

<!--    body {-->
<!--      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;-->
<!--      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);-->
<!--      min-height: 100vh;-->
<!--      padding: 20px;-->
<!--      color: #333;-->
<!--    }-->

<!--    .scanner-container {-->
<!--      max-width: 600px;-->
<!--      margin: 0 auto;-->
<!--      background: rgba(255, 255, 255, 0.95);-->
<!--      backdrop-filter: blur(10px);-->
<!--      border-radius: 20px;-->
<!--      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);-->
<!--      overflow: hidden;-->
<!--    }-->

<!--    .header {-->
<!--      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);-->
<!--      color: white;-->
<!--      padding: 30px;-->
<!--      text-align: center;-->
<!--      position: relative;-->
<!--    }-->

<!--    .header::before {-->
<!--      content: '';-->
<!--      position: absolute;-->
<!--      top: 0;-->
<!--      left: 0;-->
<!--      right: 0;-->
<!--      bottom: 0;-->
<!--      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="qr-pattern" width="20" height="20" patternUnits="userSpaceOnUse"><rect width="20" height="20" fill="none"/><rect x="2" y="2" width="4" height="4" fill="white" opacity="0.1"/><rect x="14" y="14" width="4" height="4" fill="white" opacity="0.1"/><rect x="8" y="8" width="2" height="2" fill="white" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23qr-pattern)"/></svg>');-->
<!--      pointer-events: none;-->
<!--    }-->

<!--    .header h1 {-->
<!--      font-size: 2.2em;-->
<!--      font-weight: 300;-->
<!--      margin-bottom: 10px;-->
<!--      position: relative;-->
<!--      z-index: 1;-->
<!--    }-->

<!--    .course-highlight {-->
<!--      color: #FFD700;-->
<!--      font-weight: 600;-->
<!--      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);-->
<!--    }-->

<!--    .scanner-section {-->
<!--      padding: 40px;-->
<!--      text-align: center;-->
<!--    }-->

<!--    .scanner-wrapper {-->
<!--      background: #f8f9fa;-->
<!--      border-radius: 15px;-->
<!--      padding: 20px;-->
<!--      margin-bottom: 30px;-->
<!--      border: 3px dashed #667eea;-->
<!--      transition: all 0.3s ease;-->
<!--      position: relative;-->
<!--    }-->

<!--    .scanner-wrapper.scanning {-->
<!--      border-color: #4facfe;-->
<!--      background: #f0f8ff;-->
<!--      box-shadow: 0 0 20px rgba(79, 172, 254, 0.2);-->
<!--    }-->

<!--    #reader {-->
<!--      width: 320px !important;-->
<!--      margin: auto !important;-->
<!--      border-radius: 10px;-->
<!--      overflow: hidden;-->
<!--      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);-->
<!--    }-->

<!--    #result {-->
<!--      background: white;-->
<!--      border-radius: 15px;-->
<!--      padding: 25px;-->
<!--      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);-->
<!--      border-left: 5px solid #667eea;-->
<!--      text-align: left;-->
<!--      line-height: 1.6;-->
<!--    }-->

<!--    .progress-bar {-->
<!--      background: #e9ecef;-->
<!--      border-radius: 10px;-->
<!--      height: 8px;-->
<!--      margin: 20px 0;-->
<!--      overflow: hidden;-->
<!--    }-->

<!--    .progress-fill {-->
<!--      background: linear-gradient(90deg, #4facfe, #00f2fe);-->
<!--      height: 100%;-->
<!--      border-radius: 10px;-->
<!--      transition: width 0.5s ease;-->
<!--      width: 0%;-->
<!--    }-->

<!--    .progress-text {-->
<!--      font-size: 0.9em;-->
<!--      color: #666;-->
<!--      text-align: center;-->
<!--      margin-top: 10px;-->
<!--    }-->

<!--    .qr-list {-->
<!--      margin: 15px 0;-->
<!--    }-->

<!--    .qr-list ul {-->
<!--      list-style: none;-->
<!--      padding: 0;-->
<!--    }-->

<!--    .qr-list li {-->
<!--      background: #f8f9fa;-->
<!--      margin: 8px 0;-->
<!--      padding: 12px 15px;-->
<!--      border-radius: 8px;-->
<!--      border-left: 4px solid #28a745;-->
<!--      font-family: 'Courier New', monospace;-->
<!--      transition: all 0.3s ease;-->
<!--    }-->

<!--    .qr-list li:hover {-->
<!--      background: #e9f7ef;-->
<!--      transform: translateX(5px);-->
<!--    }-->

<!--    .status-badge {-->
<!--      display: inline-block;-->
<!--      padding: 6px 12px;-->
<!--      border-radius: 20px;-->
<!--      font-size: 0.85em;-->
<!--      font-weight: 500;-->
<!--      margin: 5px 0;-->
<!--    }-->

<!--    .status-scanning {-->
<!--      background: #fff3cd;-->
<!--      color: #856404;-->
<!--      border: 1px solid #ffeeba;-->
<!--    }-->

<!--    .status-complete {-->
<!--      background: #d1edff;-->
<!--      color: #0c5460;-->
<!--      border: 1px solid #bee5eb;-->
<!--    }-->

<!--    .status-success {-->
<!--      background: #d4edda;-->
<!--      color: #155724;-->
<!--      border: 1px solid #c3e6cb;-->
<!--    }-->

<!--    .status-error {-->
<!--      background: #f8d7da;-->
<!--      color: #721c24;-->
<!--      border: 1px solid #f5c6cb;-->
<!--    }-->

<!--    .scanner-info {-->
<!--      background: #e3f2fd;-->
<!--      border-radius: 10px;-->
<!--      padding: 15px;-->
<!--      margin-bottom: 20px;-->
<!--      border-left: 4px solid #2196f3;-->
<!--    }-->

<!--    .scanner-info h3 {-->
<!--      color: #1976d2;-->
<!--      margin-bottom: 8px;-->
<!--      font-size: 1.1em;-->
<!--    }-->

<!--    .scanner-info p {-->
<!--      color: #666;-->
<!--      font-size: 0.9em;-->
<!--      margin: 0;-->
<!--    }-->

<!--    .qr-icon {-->
<!--      font-size: 2em;-->
<!--      margin-bottom: 15px;-->
<!--      opacity: 0.3;-->
<!--    }-->

<!--    .loading-animation {-->
<!--      display: inline-block;-->
<!--      width: 20px;-->
<!--      height: 20px;-->
<!--      border: 2px solid #f3f3f3;-->
<!--      border-top: 2px solid #667eea;-->
<!--      border-radius: 50%;-->
<!--      animation: spin 1s linear infinite;-->
<!--      margin-left: 10px;-->
<!--    }-->

<!--    @keyframes spin {-->
<!--      0% { transform: rotate(0deg); }-->
<!--      100% { transform: rotate(360deg); }-->
<!--    }-->

<!--    .fade-in {-->
<!--      animation: fadeIn 0.6s ease-out;-->
<!--    }-->

<!--    @keyframes fadeIn {-->
<!--      from {-->
<!--        opacity: 0;-->
<!--        transform: translateY(20px);-->
<!--      }-->
<!--      to {-->
<!--        opacity: 1;-->
<!--        transform: translateY(0);-->
<!--      }-->
<!--    }-->

<!--    @media (max-width: 768px) {-->
<!--      .scanner-container {-->
<!--        margin: 10px;-->
<!--        border-radius: 15px;-->
<!--      }-->

<!--      .header {-->
<!--        padding: 20px;-->
<!--      }-->

<!--      .header h1 {-->
<!--        font-size: 1.8em;-->
<!--      }-->

<!--      .scanner-section {-->
<!--        padding: 20px;-->
<!--      }-->

<!--      #reader {-->
<!--        width: 280px !important;-->
<!--      }-->

<!--      .scanner-wrapper {-->
<!--        padding: 15px;-->
<!--      }-->
<!--    }-->

    /* Override html5-qrcode styles */
<!--    #reader__dashboard_section {-->
<!--      display: none !important;-->
<!--    }-->

<!--    #reader__camera_selection {-->
<!--      margin-bottom: 15px;-->
<!--    }-->

<!--    #reader select {-->
<!--      padding: 8px 12px;-->
<!--      border-radius: 8px;-->
<!--      border: 2px solid #ddd;-->
<!--      font-size: 14px;-->
<!--      background: white;-->
<!--    }-->
<!--  </style>-->
<!--</head>-->
<!--<body>-->
<!--  <div class="scanner-container fade-in">-->
<!--    <div class="header">-->
<!--      <h1>üîç QR Scanner - Course <span class="course-highlight">{{ course_id }}</span></h1>-->
<!--    </div>-->

<!--    <div class="scanner-section">-->
<!--      <div class="scanner-info">-->
<!--        <h3>üìã Instructions</h3>-->
<!--        <p>Position QR codes within the scanning area. The scanner will automatically detect and save unique codes (4 required).</p>-->
<!--      </div>-->

<!--      <div class="scanner-wrapper" id="scanner-wrapper">-->
<!--        <div id="reader"></div>-->
<!--      </div>-->

<!--      <div class="progress-bar">-->
<!--        <div class="progress-fill" id="progress-fill"></div>-->
<!--      </div>-->
<!--      <div class="progress-text" id="progress-text">Ready to scan - 0/4 codes detected</div>-->

<!--      <div id="result"></div>-->
<!--    </div>-->
<!--  </div>-->

<!--  <script>-->
<!--    let scannedQRCodes = [];-->
<!--    let html5QrcodeScanner;-->
<!--    const courseId = {{ course_id }};-->

<!--    function updateProgress() {-->
<!--      const progressFill = document.getElementById('progress-fill');-->
<!--      const progressText = document.getElementById('progress-text');-->
<!--      const scannerWrapper = document.getElementById('scanner-wrapper');-->

<!--      const percentage = (scannedQRCodes.length / 4) * 100;-->
<!--      progressFill.style.width = percentage + '%';-->

<!--      if (scannedQRCodes.length === 0) {-->
<!--        progressText.innerHTML = 'Ready to scan - 0/4 codes detected';-->
<!--        scannerWrapper.classList.remove('scanning');-->
<!--      } else if (scannedQRCodes.length < 4) {-->
<!--        progressText.innerHTML = `Scanning in progress - ${scannedQRCodes.length}/4 codes detected`;-->
<!--        scannerWrapper.classList.add('scanning');-->
<!--      } else {-->
<!--        progressText.innerHTML = 'Scanning complete! ‚úÖ';-->
<!--        scannerWrapper.classList.remove('scanning');-->
<!--      }-->
<!--    }-->

<!--    function updateScannedList() {-->
<!--      const resultDiv = document.getElementById('result');-->
<!--      if (scannedQRCodes.length === 0) {-->
<!--        resultDiv.innerHTML = `-->
<!--          <div style="text-align: center;">-->
<!--            <div class="qr-icon">üì±</div>-->
<!--            <p><strong>Course ID:</strong> ${courseId}</p>-->
<!--            <p style="color: #666; font-size: 0.9em; margin-top: 10px;">No QR codes scanned yet. Point your camera at a QR code to begin.</p>-->
<!--          </div>-->
<!--        `;-->
<!--      } else {-->
<!--        const statusBadge = scannedQRCodes.length < 4-->
<!--          ? '<span class="status-badge status-scanning">üîÑ Scanning...</span>'-->
<!--          : '<span class="status-badge status-complete">‚úÖ Complete</span>';-->

<!--        resultDiv.innerHTML = `-->
<!--          <div style="text-align: center;">-->
<!--            <strong>üìã Course ID:</strong> ${courseId} ${statusBadge}-->
<!--            <div class="qr-list">-->
<!--              <strong>üéØ Scanned QR Codes: ${scannedQRCodes.length}/4</strong>-->
<!--              <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-top: 15px; max-width: 200px; margin-left: auto; margin-right: auto;">-->
<!--                ${Array.from({length: 4}, (_, index) =>-->
<!--                  `<div style="width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.2em; ${-->
<!--                    index < scannedQRCodes.length-->
<!--                      ? 'background: #d4edda; color: #155724; border: 2px solid #28a745;'-->
<!--                      : 'background: #f8f9fa; color: #6c757d; border: 2px dashed #dee2e6;'-->
<!--                  }">-->
<!--                    ${index < scannedQRCodes.length ? '‚úÖ' : '‚≠ï'}-->
<!--                  </div>`-->
<!--                ).join('')}-->
<!--              </div>-->
<!--            </div>-->
<!--          </div>-->
<!--        `;-->
<!--      }-->
<!--      updateProgress();-->
<!--    }-->

<!--    function onScanSuccess(decodedText, decodedResult) {-->
<!--      if (!scannedQRCodes.includes(decodedText)) {-->
<!--        scannedQRCodes.push(decodedText);-->
<!--        updateScannedList();-->

<!--        if (scannedQRCodes.length === 4) {-->
<!--          html5QrcodeScanner.clear();-->
<!--          document.getElementById('result').innerHTML += `-->
<!--            <div style="margin-top: 20px; text-align: center;">-->
<!--              <span class="status-badge status-complete">üéâ Scanning complete! Saving data...</span>-->
<!--              <div class="loading-animation"></div>-->
<!--            </div>-->
<!--          `;-->

          // Send all 4 codes and course ID to backend
<!--          fetch('/save', {-->
<!--            method: 'POST',-->
<!--            headers: { 'Content-Type': 'application/json' },-->
<!--            body: JSON.stringify({-->
<!--              course_id: courseId,-->
<!--              qr_codes: scannedQRCodes,-->
<!--              data: scannedQRCodes.join('\n')-->
<!--            })-->
<!--          })-->
<!--          .then(response => response.json())-->
<!--          .then(data => {-->
<!--            const resultDiv = document.getElementById('result');-->
<!--            if (data.success) {-->
<!--              resultDiv.innerHTML += `-->
<!--                <div style="margin-top: 15px; text-align: center;">-->
<!--                  <span class="status-badge status-success">‚úÖ Successfully saved to database!</span>-->
<!--                </div>-->
<!--              `;-->
<!--            } else {-->
<!--              resultDiv.innerHTML += `-->
<!--                <div style="margin-top: 15px; text-align: center;">-->
<!--                  <span class="status-badge status-error">‚ùå Error saving data: ${data.error}</span>-->
<!--                </div>-->
<!--              `;-->
<!--            }-->
<!--          })-->
<!--          .catch(error => {-->
<!--            console.error('Error:', error);-->
<!--            document.getElementById('result').innerHTML += `-->
<!--              <div style="margin-top: 15px; text-align: center;">-->
<!--                <span class="status-badge status-error">‚ùå Network error occurred!</span>-->
<!--              </div>-->
<!--            `;-->
<!--          });-->
<!--        }-->
<!--      }-->
<!--    }-->

<!--    function onScanFailure(error) {-->
      // Handle scan failure, usually better to ignore
<!--    }-->

<!--    window.onload = function() {-->
<!--      html5QrcodeScanner = new Html5QrcodeScanner(-->
<!--        "reader", {-->
<!--          fps: 10,-->
<!--          qrbox: 250,-->
<!--          aspectRatio: 1.0-->
<!--        });-->
<!--      html5QrcodeScanner.render(onScanSuccess, onScanFailure);-->
<!--      updateScannedList();-->
<!--    }-->
<!--  </script>-->
<!--</body>-->
<!--</html>-->






<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <title>QR Scanner</title>-->
<!--  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">-->
<!--  <script src="https://unpkg.com/html5-qrcode"></script>-->
<!--</head>-->
<!--<body>-->
<!--  <h1>QR Scanner - Course {{ course_id }}</h1>-->
  <!-- Timer removed, scanner always open -->
<!--  <div id="reader" style="width:300px; margin:auto;"></div>-->
<!--  <div id="result"></div>-->
<!--  <script>-->
<!--    let scannedQRCodes = [];-->
<!--    let html5QrcodeScanner;-->
<!--    const courseId = {{ course_id }};-->

<!--    function updateScannedList() {-->
<!--      const resultDiv = document.getElementById('result');-->
<!--      if (scannedQRCodes.length === 0) {-->
<!--        resultDiv.innerHTML = '<p>No QR codes scanned yet.</p><p>Course ID: ' + courseId + '</p>';-->
<!--      } else {-->
<!--        resultDiv.innerHTML = '<b>Course ID: ' + courseId + '</b><br>' +-->
<!--          '<b>Unique Scanned QR Codes (' + scannedQRCodes.length + '/4):</b><ul>' +-->
<!--          scannedQRCodes.map(code => `<li style="color:green">‚úÖ ${code}</li>`).join('') + '</ul>';-->
<!--      }-->
<!--    }-->

<!--    function onScanSuccess(decodedText, decodedResult) {-->
<!--      if (!scannedQRCodes.includes(decodedText)) {-->
<!--        scannedQRCodes.push(decodedText);-->
<!--        updateScannedList();-->

<!--        if (scannedQRCodes.length === 4) {-->
<!--          html5QrcodeScanner.clear();-->
<!--          document.getElementById('result').innerHTML += '<br><b>Scanning complete! Saving data...</b>';-->

          // Send all 4 codes and course ID to backend
<!--          fetch('/save', {-->
<!--            method: 'POST',-->
<!--            headers: { 'Content-Type': 'application/json' },-->
<!--            body: JSON.stringify({-->
<!--              course_id: courseId,-->
<!--              qr_codes: scannedQRCodes,-->
<!--              data: scannedQRCodes.join('\n')-->
<!--            })-->
<!--          })-->
<!--          .then(response => response.json())-->
<!--          .then(data => {-->
<!--            if (data.success) {-->
<!--              document.getElementById('result').innerHTML += '<br><b style="color:green">‚úÖ Successfully saved to database!</b>';-->
<!--            } else {-->
<!--              document.getElementById('result').innerHTML += '<br><b style="color:red">‚ùå Error saving data: ' + data.error + '</b>';-->
<!--            }-->
<!--          })-->
<!--          .catch(error => {-->
<!--            console.error('Error:', error);-->
<!--            document.getElementById('result').innerHTML += '<br><b style="color:red">‚ùå Network error occurred!</b>';-->
<!--          });-->
<!--        }-->
<!--      }-->
<!--    }-->

<!--    function onScanFailure(error) {-->
      // Handle scan failure, usually better to ignore
<!--    }-->

<!--    window.onload = function() {-->
<!--      html5QrcodeScanner = new Html5QrcodeScanner(-->
<!--        "reader", {-->
<!--          fps: 10,-->
<!--          qrbox: 250,-->
<!--          aspectRatio: 1.0-->
<!--        });-->
<!--      html5QrcodeScanner.render(onScanSuccess, onScanFailure);-->
<!--      updateScannedList();-->
<!--    }-->
<!--  </script>-->
<!--</body>-->
<!--</html>-->



<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <title>QR Scanner</title>-->
  <!--<link rel="stylesheet" href="{{ url_for('static', filename='scanner.css') }}">-->
<!--  <script src="https://unpkg.com/html5-qrcode"></script>-->
<!--</head>-->
<!--<body>-->
<!--  <h1>QR Scanner 2</h1>-->
  <!-- Timer removed, scanner always open -->
<!--  <div id="reader" style="width:300px; margin:auto;"></div>-->
<!--  <div id="result"></div>-->
<!--  <script>-->
<!--    let scannedQRCodes = [];-->
<!--    let html5QrcodeScanner;-->


<!--    function updateScannedList() {-->
<!--      const resultDiv = document.getElementById('result');-->
<!--      if (scannedQRCodes.length === 0) {-->
<!--        resultDiv.innerText = 'No QR codes scanned yet.';-->
<!--      } else {-->
<!--        resultDiv.innerHTML = '<b>Unique Scanned QR Codes:</b><ul>' +-->
<!--          scannedQRCodes.map(code => `<li style="color:green">‚úîÔ∏è ${code}</li>`).join('') + '</ul>';-->
<!--      }-->
<!--    }-->

<!--    function onScanSuccess(decodedText, decodedResult) {-->
<!--      if (!scannedQRCodes.includes(decodedText)) {-->
<!--        scannedQRCodes.push(decodedText);-->
<!--        updateScannedList();-->
<!--        if (scannedQRCodes.length === 4) {-->
<!--          html5QrcodeScanner.clear();-->
          // Send all 4 codes to backend to save in contain.textfile
<!--          fetch('/save', {-->
<!--            method: 'POST',-->
<!--            headers: { 'Content-Type': 'application/json' },-->
<!--            body: JSON.stringify({ data: scannedQRCodes.join('\n') })-->
<!--          }).then(() => {-->
<!--            document.getElementById('result').innerHTML += '<br><b>Saved to contain.textfile!</b>';-->
<!--          });-->
<!--        }-->
<!--      }-->
<!--    }-->

<!--    window.onload = function() {-->
<!--      html5QrcodeScanner = new Html5QrcodeScanner(-->
<!--        "reader", { fps: 10, qrbox: 250 });-->
<!--      html5QrcodeScanner.render(onScanSuccess);-->
<!--      updateScannedList();-->
<!--    }-->
<!--  </script>-->
<!--</body>-->
<!--</html>-->






<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>QR Scanner</title>-->
<!--  <link rel="stylesheet" href="{{ url_for('static', filename='scanner.css') }}">-->
<!--  <script src="https://unpkg.com/html5-qrcode"></script>-->
<!--</head>-->
<!--<body>-->
<!--  <h1>QR Scanner 2</h1>-->

<!--  <div class="scanner-container">-->
<!--    <div id="reader" class="hidden"></div>-->
<!--    <div class="scanner-status" id="scannerStatus">-->
<!--      üì± Click the button below to start scanning QR codes-->
<!--    </div>-->
<!--    <button class="start-btn" id="startBtn" onclick="startScanning()">-->
<!--      üöÄ Start Scanning-->
<!--    </button>-->
<!--  </div>-->

<!--  <div class="result-container">-->
<!--    <h3>üìã Scan Progress</h3>-->
<!--    <div class="progress-bar">-->
<!--      <div class="progress-fill" id="progressFill" style="width: 0%"></div>-->
<!--    </div>-->
<!--    <div class="progress-text" id="progressText">0 of 4 codes scanned</div>-->
<!--    <div id="result"></div>-->
<!--  </div>-->

<!--  <script src="{{ url_for('static', filename='scanner.js') }}"></script>-->
<!--</body>-->
<!--</html>-->









<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>QR Scanner</title>-->
<!--  <link rel="stylesheet" href="{{ url_for('static', filename='scanner.css') }}">-->
<!--  <script src="https://unpkg.com/html5-qrcode/minified/html5-qrcode.min.js"></script>-->

<!--</head>-->
<!--<body>-->
<!--  <h1>QR Scanner</h1>-->

<!--  <div class="scanner-container">-->
<!--    <div id="reader" class="hidden"></div>-->
<!--    <div class="scanner-status" id="scannerStatus">-->
<!--      üì± Click the button below to start scanning QR codes-->
<!--    </div>-->
<!--    <button class="start-btn" id="startBtn" onclick="startScanning()">-->
<!--      üöÄ Start Scanning-->
<!--    </button>-->
<!--  </div>-->

<!--  <div class="result-container">-->
<!--    <h3>üìã Scan Progress</h3>-->
<!--    <div class="progress-bar">-->
<!--      <div class="progress-fill" id="progressFill" style="width: 0%"></div>-->
<!--    </div>-->
<!--    <div class="progress-text" id="progressText">0 of 4 codes scanned</div>-->
<!--    <div id="result"></div>-->
<!--  </div>-->

  <!-- üëá inject courseId BEFORE scanner.js -->
<!--  <script>-->
<!--    var courseId = "{{ course_id }}";-->
<!--  </script>-->
<!--  <script src="{{ url_for('static', filename='scanner.js') }}"></script>-->
<!--</body>-->
<!--</html>-->

<!--<!DOCTYPE html>-->
<!--<html lang="en">-->
<!--<head>-->
<!--  <meta charset="UTF-8">-->
<!--  <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--  <title>QR Scanner</title>-->
<!--  <link rel="stylesheet" href="{{ url_for('static', filename='scanner.css') }}">-->
<!--  <script src="https://unpkg.com/html5-qrcode"></script>-->
<!--</head>-->
<!--<body>-->
<!--  <h1>QR Scanner 2</h1>-->

<!--  <div class="scanner-container">-->
<!--    <div id="reader" class="hidden"></div>-->
<!--    <div class="scanner-status" id="scannerStatus">-->
<!--      üì± Click the button below to start scanning QR codes-->
<!--    </div>-->
<!--    <button class="start-btn" id="startBtn" onclick="startScanning()">-->
<!--      üöÄ Start Scanning-->
<!--    </button>-->
<!--  </div>-->

<!--  <div class="result-container">-->
<!--    <h3>üìã Scan Progress</h3>-->
<!--    <div class="progress-bar">-->
<!--      <div class="progress-fill" id="progressFill" style="width: 0%"></div>-->
<!--    </div>-->
<!--    <div class="progress-text" id="progressText">0 of 4 codes scanned</div>-->
<!--    <div id="result"></div>-->
<!--  </div>-->

<!--  <script src="{{ url_for('static', filename='scanner.js') }}"></script>-->
<!--</body>-->
<!--</html>-->